harem_politics_favored_consort_trigger = {
	OR = {
		has_character_modifier = favored_consort_modifier
		has_character_modifier = beloved_consort_modifier
		has_character_modifier = favor_boost_modifier
	}
	trigger_if = { #Can't be unfavored
		limit = { 
			has_variable = favor
		}
		trigger_if = { #Favor boost applies since neutral level
			limit = { 
				has_character_modifier = favor_boost_modifier
			}
			var:favor >= neutral_consort_lower_limit
		}
		trigger_else = {
			var:favor >= favorite_consort_lower_limit
		}
	}
	trigger_else = {
		NOT = {
			has_variable = favor
		}
	}
}

harem_politics_beloved_consort_trigger = {
	has_character_modifier = beloved_consort_modifier
	trigger_if = { #Can't be favored-
		limit = { 
			has_variable = favor
		}
		var:favor >= beloved_consort_lower_limit
	}
	trigger_else = {
		NOT = {
			has_variable = favor
		}
	}
}

harem_politics_unfavored_consort_trigger = {
	OR = {
		has_character_modifier = unfavored_consort_modifier
		has_character_modifier = forgotten_consort_modifier
	}
	NOT = {
		has_character_modifier = favor_boost_modifier
	}
	trigger_if = { #Can't be favored
		limit = { 
			has_variable = favor
		}
		var:favor < neutral_consort_lower_limit
	}
	trigger_else = {
		NOT = {
			has_variable = favor
		}
	}
}

harem_politics_forgotten_consort_trigger = {
	has_character_modifier = forgotten_consort_modifier
	NOT = {
		has_character_modifier = favor_boost_modifier
	}
	trigger_if = { #Can't be unfavored+
		limit = { 
			has_variable = favor
		}
		var:favor < unfavored_consort_lower_limit
	}
	trigger_else = {
		NOT = {
			has_variable = favor
		}
	}
}

harem_politics_punished_consort_trigger = {
	OR = {
		has_character_flag = flag_scolded_consort
		has_character_modifier = sleep_deprived_modifier
		has_character_modifier = intrigue_starved_and_deprived_modifier
		has_character_modifier = recently_tortured
		has_character_modifier = hunt_tasted_the_belt_modifier
	}
}


## Special consorts ##
harem_politics_special_consort_trigger = {
	OR = {
		has_character_flag = flag_yanwan
		has_character_flag = flag_nurbanu
		has_character_flag = flag_hailan
		has_character_flag = flag_mei
	}
}

## Bad night event trigger ##
harem_politics_accident_event_trigger = {
	any_consort = {
		harem_politics_bad_night_jealous_consort_trigger = yes
	}
	NOT = {
		any_court_position_holder = {
			type = grand_consort_court_position
			aptitude:grand_consort_court_position = 5
			has_character_flag = gc_balancing_favor_flag
		}
	}
}
harem_politics_bad_night_jealous_consort_trigger = {
	is_valid_for_favor_system_trigger = { HAREM_LIEGE = scope:actor }
	is_imprisoned = no
	is_ai = yes
	is_physically_able = yes
	location ?= scope:actor.location

	harem_politics_unfavored_consort_trigger = no
	harem_politics_evil_consort_trigger = yes
	harem_politics_punished_consort_trigger = no
	calyver_rank_is_superior_trigger = {
		HAREM_LIEGE = scope:actor
		AUTHORITY = this
		TARGET_CONSORT = scope:recipient
	}
	trigger_if = {
		limit = {
			scope:actor.religion = religion:islam_religion
		}
		scope:recipient = {
			NOT = {
				is_spouse_of = scope:actor
			}
		}
	}

	OR = {
		has_trait = sadistic
		has_trait = vengeful
		has_trait = wrathful
	}
	NOR = {
		this = scope:recipient
		has_relation_rival = scope:actor
		has_relation_nemesis = scope:actor
		has_opinion_modifier = {
			modifier = forced_me_concubine_marriage_opinion
			target = scope:actor
		}
		has_relation_friend = scope:recipient
		has_relation_best_friend = scope:recipient
		has_relation_lover = scope:recipient
		has_relation_soulmate = scope:recipient

		has_trait = temperate
		has_trait = calm
		has_trait = craven
		has_trait = shy
	}
	opinion = {
		target = scope:recipient
		value <= 0
	}
	OR = {
		AND = {
			ai_rationality < 10
			ai_honor < 0
		}
		ai_rationality < 0
	}
}

#Favor system#
is_valid_for_favor_system_trigger = {
	is_courtier_of = $HAREM_LIEGE$
	is_alive = yes
	is_incapable = no
	OR = {
		is_imprisoned_by = $HAREM_LIEGE$
		is_imprisoned = no
	}
}


harem_politics_is_valid_authority_trigger = {
    # $AUTHORITY$ is the high-ranking character
    # $TARGET$ is the lower-ranked character
    # $LIEGE$ is the harem owner

    $AUTHORITY$ = { 
		is_valid_harem_member_trigger = {
			LIEGE = $LIEGE$
		}
	}
    $TARGET$ = {
		is_valid_harem_member_trigger = {
			LIEGE = $LIEGE$
		}
	}

    trigger_if = {
        # 1. If authority is a relative (not a consort), target must be a consort
		# 2. If authority is primary spouse, target must be a consort
        limit = {
            $AUTHORITY$ = {
				NOT = {
					is_consort_of = $LIEGE$
				}
            }
        }
		trigger_if = {
			limit = {
				$AUTHORITY$ = {
					is_parent_of = $LIEGE$
				}
			}
			always = yes
		}
		trigger_else_if = {
			limit = {
				$AUTHORITY$ = {
					is_grandparent_of = $LIEGE$
				}
			}
			$TARGET$ = {
				NOR = {
					is_parent_of = $LIEGE$
					is_grandparent_of = $LIEGE$
				}
			}
		}
		trigger_else_if = {
			limit = {
				$AUTHORITY$ = {
					is_uncle_or_aunt_of = $LIEGE$
				}
			}
			$TARGET$ = {
				NOR = {
					is_uncle_or_aunt_of = $LIEGE$
					is_parent_of = $LIEGE$
					is_grandparent_of = $LIEGE$
				}
			}
		}
		trigger_else_if = {
			limit = {
				$AUTHORITY$ = {
					is_sibling_of = $LIEGE$
				}
			}
			$TARGET$ = {
				NOR = {
					is_sibling_of = $LIEGE$
					is_uncle_or_aunt_of = $LIEGE$
					is_parent_of = $LIEGE$
					is_grandparent_of = $LIEGE$
				}
			}
		}
		trigger_else = {
			$TARGET$ = {
				is_consort_of = $LIEGE$
			}
		}
    }
	trigger_else_if = {
		limit = {
			$LIEGE$.primary_spouse ?= $AUTHORITY$
		}
		$TARGET$ = {
			is_consort_of = $LIEGE$
		}
	}
    trigger_else_if = {
        # 3. If authority is Grand Consort, target must be a consort but not the PS
        limit = {
            $AUTHORITY$ = { has_court_position = grand_consort_court_position }
        }
		$TARGET$ = {
			is_consort_of = $LIEGE$
			trigger_if = {
				limit = {
					exists = $LIEGE$.primary_spouse
				}
				NOT = {
					this = $LIEGE$.primary_spouse
				}
			}
		}
    }
    trigger_else_if = {
        # 4. If authority is a spouse (not PS), target must be a concubine
        limit = {
            $AUTHORITY$ = {
                is_spouse_of = $LIEGE$
            }
        }
        $TARGET$ = { is_concubine_of = $LIEGE$ }
    }
    trigger_else = {
        always = no
    }
}

harem_politics_ranks_the_same_as_target_trigger = {
	# CHARACTER = is the character being checked
	# TARGET = is the character being compared to
	# LIEGE = is the harem owner

	$CHARACTER$ = { 
		is_valid_harem_member_trigger = {
			LIEGE = $LIEGE$
		}
		NOT = {
			has_court_position = grand_consort_court_position
		}
		trigger_if = {
			limit = {
				exists = $LIEGE$.primary_spouse
			}
			NOT = {
				this = $LIEGE$.primary_spouse
			}
		}
	}
    $TARGET$ = {
		is_valid_harem_member_trigger = {
			LIEGE = $LIEGE$
		}
		NOR = {
			is_child_of = $CHARACTER$
			is_parent_of = $CHARACTER$
			is_grandparent_of = $CHARACTER$
			is_uncle_or_aunt_of = $CHARACTER$
			is_nibling_of = $CHARACTER$
			is_consort_of = $CHARACTER$
			has_court_position = grand_consort_court_position
		}
		trigger_if = {
			limit = {
				exists = $LIEGE$.primary_spouse
			}
			NOT = {
				this = $LIEGE$.primary_spouse
			}
		}
	}

	trigger_if = {
		limit = {
			$CHARACTER$ = {
				NOT = {
					is_consort_of = $LIEGE$
				}
			}
		}
		$TARGET$ = {
			NOT = { is_consort_of = $LIEGE$ }
		}
		trigger_if = {
			limit = {
				$TARGET$ = {
					is_parent_of = $LIEGE$
				}
			}
			$CHARACTER$ = {
				is_parent_of = $LIEGE$
			}
		}
		trigger_else_if = {
			limit = {
				$TARGET$ = {
					is_grandparent_of = $LIEGE$
				}
			}
			$CHARACTER$ = {
				is_grandparent_of = $LIEGE$
			}
		}
		trigger_else_if = {
			limit = {
				$TARGET$ = {
					is_uncle_or_aunt_of = $LIEGE$
				}
			}
			$CHARACTER$ = {
				is_uncle_or_aunt_of = $LIEGE$
			}
		}
		trigger_else_if = {
			limit = {
				$TARGET$ = {
					is_sibling_of = $LIEGE$
				}
			}
			$CHARACTER$ = {
				is_sibling_of = $LIEGE$
			}
		}
	}
	trigger_else = {
		trigger_if = {
			limit = {
				exists = $LIEGE$.primary_spouse
				$TARGET$ = {
					is_spouse_of = $LIEGE$
					NOT = {
						this = $LIEGE$.primary_spouse
					}
				}
			}
			$CHARACTER$ = {
				is_spouse_of = $LIEGE$
				NOT = {
					this = $LIEGE$.primary_spouse
				}
			}
		}
		trigger_else_if = {
			limit = {
				$TARGET$ = {
					is_concubine_of = $LIEGE$
				}
			}
			$CHARACTER$ = {
				is_concubine_of = $LIEGE$
			}
		}
	}
}

#########################
## Bride Show triggers ##
#########################
agrees_with_bride_show = {
	OR = {
		culture = { has_cultural_tradition = tradition_ep3_palace_politics }
		culture = { has_cultural_tradition = tradition_legalistic }
		hp_accepts_harems = yes
	}
}

can_have_five_candidates_trigger = {
	OR = {
		highest_held_title_tier > tier_empire
		any_vassal = {
			count >= 30
		}
		AND = {
			government_allows = administrative
			any_vassal_or_below = {
				count >= 30
			}
		}
	}
}
can_have_four_candidates_trigger = {
	OR = {
		highest_held_title_tier >= tier_empire
		any_vassal = {
			count >= 9
		}
		AND = {
			government_allows = administrative
			any_vassal_or_below = {
				count >= 9
			}
		}
	}
}

######################
##Potential consorts##
######################

## Basic trigger - used for all the other triggers ##
bride_show_beauty_important_parameters_trigger = {
	NOR = {
		has_character_modifier = malnourished_modifier
		current_weight < -50
		has_character_modifier = obese_modifier
		current_weight > 50
		has_trait = beauty_bad
	}
}
bride_show_viable_consort_trigger = {
	is_available_quick = {
		ruler = no
		hostage = no
	}
	is_available = yes
	is_healthy = yes
	has_any_disease_trigger = no
	has_easily_mocked_physical_attribute_trigger = no
	age <= 23
	age >= 15
	NOR = {
		any_consort = {
			count > 0
		}
		any_heir_title = {
			place_in_line_of_succession = {
				target = prev
				value <= 2
			}
		}
		#If you betrothed them already, why should they participate?
		betrothed ?= { is_close_family_of = $OVERLORD$ }
		has_council_position = councillor_court_chaplain
		is_close_family_of = $OVERLORD$
		has_trait = devoted
		has_trait = celibate
		has_trait = lunatic_1
		has_trait = lunatic_genetic
		has_trait = possessed_1
		has_trait = possessed_genetic
		has_trait = lisping
		has_trait = stuttering

		has_trait = wheezing

		has_trait = eunuch
		has_trait = adulterer
		has_trait = fornicator
		has_trait = deviant
		has_trait = murderer
		has_trait = kinslayer_1
		has_trait = kinslayer_2
		has_trait = kinslayer_3
		has_trait = incestuous
		has_trait = excommunicated
		has_trait = drunkard
		has_trait = hashishiyah

		has_trait = infirm
		has_trait = incapable

		has_trait = physique_bad_3	#Weak candidates wouln't make it to the capital without getting sick.

		has_trait = pregnant
	}
	can_take_as_concubine_character_trigger = { CHARACTER = $OVERLORD$ }
	can_be_taken_as_muslim_concubine_trigger = {  # Can a Muslim be taken as concubine?
		CHARACTER = $OVERLORD$
		RECEIVER = $OVERLORD$
	}
}
## Trigger for the bride show ##
bride_show_viable_candidate_trigger = {
	bride_show_viable_consort_trigger = {
		OVERLORD = $OVERLORD$
	}
	trigger_if = { #If they aren't betrothed, you can arrange a marriage with them
		limit = {
			is_adult = no
		}
		betrothed ?= {
			NOT = {
				is_close_family_of = $OVERLORD$
			}
		}
		$OVERLORD$ = {
			is_ai = no
		}
	}
	trigger_else = {
		is_adult = yes
	}
	trigger_if = { #Beauty parameters
		limit = {
			OR = { #Tributaries would never send ugly candidates
				$OVERLORD$ = { has_variable = beauty_important }
				court_owner ?= {
					is_tributary_of = $OVERLORD$
				}
			}
		}
		bride_show_beauty_important_parameters_trigger = yes
	}
	trigger_if = { #Intellectual parameters
		limit = {
			OR = { #Tributaries would never send stupid candidates
				$OVERLORD$ = { has_variable = personality_skills_important }
				court_owner ?= {
					is_tributary_of = $OVERLORD$
				}
			}
		}
		NOT = {
			has_trait = intellect_bad
		}
	}
}

###########################
## For Muslim concubines ##
###########################

## Basic trigger ##
basic_viable_candidate_muslim_trigger = {
	is_adult = yes
	bride_show_viable_consort_trigger = {
		OVERLORD = $OVERLORD$
	}
	NOR = {
		any_close_family_member = {
			highest_held_title_tier >= tier_county
		}
		has_character_flag = has_been_offered_as_concubine
		has_character_flag = recently_abducted_concubine
	}
	trigger_if = {
		limit = { exists = court_owner }
		NOT = { is_of_major_or_minor_interest_trigger = { CHARACTER = court_owner } }
	}
}

## Trigger for dukes ##
recruit_concubines_viable_candidate_trigger = {
	basic_viable_candidate_muslim_trigger = {
		OVERLORD = $OVERLORD$
	}
	trigger_if = {
		limit = {
			$OVERLORD$.religion = religion:islam_religion
		}
		trigger_if = {
			limit = {
				religion = religion:islam_religion
			}
			has_character_flag = abducted_non_believer
		}
		trigger_else = {
			religion != religion:islam_religion
		}
		trigger_if = {
			limit = {
				exists = court_owner
			}
			court_owner = {
				NOR = {
					religion = religion:islam_religion
					is_liege_or_above_of = $OVERLORD$
					is_vassal_or_below_of = $OVERLORD$
					is_tributary_of = $OVERLORD$
				}
			}
		}
	}
}

## Trigger for kings and above ##
min_personality_and_skills_trigger = {
	OR = {
		diplomacy >= average_skill_level
		learning >= average_skill_level
		trigger_if = {
			limit = {
				can_be_knight_trigger = { ARMY_OWNER = root }
			}
			prowess >= average_skill_level
		}
		has_trait = lifestyle_poet
	}
	NOT = {
		has_trait = intellect_bad
	}
}
royal_concubines_eligible_candidate_trigger = {
	basic_viable_candidate_muslim_trigger = {
		OVERLORD = $OVERLORD$
	}
	is_virgin_trigger = yes
	# Beauty
	trigger_if = {
		limit = {
			OR = {	
				$OVERLORD$ = { has_variable = beauty_important }
				court_owner ?= {
					is_tributary_of = $OVERLORD$
				}
			}
		}
		bride_show_beauty_important_parameters_trigger = yes
	}
}

##############
## Counties ##
#############

## Trigger for dukes ##
recruit_concubines_viable_county_trigger = {
	OR = {
		any_pool_character = {
			province = this
			recruit_concubines_viable_candidate_trigger = {
				OVERLORD = $OVERLORD$
			}
		}
		trigger_if = {
			limit = {
				$OVERLORD$.religion = religion:islam_religion
			}
			religion != religion:islam_religion
			exists = county.holder
			county.holder.top_liege ?= { religion != religion:islam_religion }
		}
	}
}

## Trigger for kings and above ##
recruit_royal_concubines_viable_county_trigger = {
	OR = {
		any_pool_character = {
			province = this
			royal_concubines_eligible_candidate_trigger = {
				OVERLORD = $OVERLORD$
			}
		}
		AND = {
			religion != religion:islam_religion
			exists = county.holder
			county.holder.top_liege ?= { religion != religion:islam_religion }
		}
	}
}

#####################################
## Bride Show subject requirements ##
#####################################
# Base trigger #
harem_politics_valid_bride_show_subject_trigger = {
	OR = {
		is_vassal_of = $OVERLORD$
		is_tributary_of = $OVERLORD$
		trigger_if = {
			limit = {
				is_vassal_or_below_of = $OVERLORD$
			}
			$OVERLORD$ = {
				government_allows = administrative
			}
			government_allows = administrative
			any_held_title = { is_noble_family_title = yes }
		}
	}
	NOR = {	
		is_at_war_with = $OVERLORD$
		government_has_flag = government_is_theocracy
		government_has_flag = government_is_republic
		government_has_flag = government_is_herder
		has_opinion_modifier = {
			modifier = demanded_concubine_opinion
			target = $OVERLORD$
		}
		has_character_modifier = isolating_modifier
		capital_county = { has_county_modifier = isolate_capital_decision_modifier }
	}
	is_imprisoned = no
	NOT = {
		any_close_family_member = {
			OR = {
				is_liege_or_above_of = $OVERLORD$
				any_tributary = {
					this = $OVERLORD$
				}
			}
		}
	}
}
harem_politics_valid_tributary_requirements_trigger = {
	trigger_if = {
		limit = {
			$OVERLORD$ = {
				OR = {
					highest_held_title_tier >= tier_hegemony 
					government_has_flag = government_is_mandala
				}
			}
		}
		NOT = { var:tribute_mission_grace ?= $OVERLORD$ }
	}
	trigger_if = { #Else, if they rank the same as their suzerain, they need to dread them
		limit = {
			highest_held_title_tier = $OVERLORD$.highest_held_title_tier
		}
		OR = {
			has_dread_level_towards = {
				target = $OVERLORD$
				level >= 1
			}
			opinion = {
				target = $OVERLORD$
				value >= 15
			}
		}
	}
	trigger_else_if = { #Else, they need to dread them more
		limit = {
			highest_held_title_tier > $OVERLORD$.highest_held_title_tier
		}
		OR = {
			has_dread_level_towards = {
				target = $OVERLORD$
				level >= 2
			}
			opinion = {
				target = $OVERLORD$
				value >= 30
			}
		}
	}
	trigger_else = { #Or lower tier than their suzerain
		highest_held_title_tier < $OVERLORD$.highest_held_title_tier
		opinion = {
			target = $OVERLORD$
			value >= -10
		}
	}
}
harem_politics_is_valid_bride_show_subject_trigger = {
	harem_politics_valid_bride_show_subject_trigger = { OVERLORD = $OVERLORD$ }
	# Nomadic rulers
	trigger_if = {
		limit = {
			$OVERLORD$ = {
				government_has_flag = government_is_nomadic
			}
		}
		is_obedient_to = $OVERLORD$
	}
	# Vassals
	trigger_else_if = {
		limit = {
			is_vassal_or_below_of = $OVERLORD$
		}
		# Admin rulers
		trigger_if = {
			limit = {
				$OVERLORD$ = {
					government_allows = administrative
				}
			}
			$OVERLORD$ = {
				is_governor = no
				is_independent_ruler = yes
			}
			trigger_if = { # Low Imperial Bureaucracy
				limit = { 
					$OVERLORD$ = { 
						has_realm_law = imperial_bureaucracy_0
					} 
				}
				trigger_if = {
					limit = {
						government_allows = administrative
					}
					house ?= {
						is_dominant_family = no
						is_powerful_family = no
					}
				}
				trigger_else = {
					trigger_if = {
						limit = { $OVERLORD$ = { highest_held_title_tier > tier_duchy } }
						tier_difference = {
							target = $OVERLORD$
							value <= -2
						}
					}
					NOT = { is_powerful_vassal_of = $OVERLORD$ }
				}
			}
			trigger_else_if = { # Limited Imperial Bureaucracy
				limit = { 
					$OVERLORD$ = { 
						has_realm_law = imperial_bureaucracy_1 
					} 
				}
				trigger_if = {
					limit = {
						government_allows = administrative
					}
					house ?= {
						is_dominant_family = no
					}
				}
				trigger_else = {
					trigger_if = { # Kings and above
						limit = { $OVERLORD$ = { highest_held_title_tier > tier_duchy } }
						NOT = { is_powerful_vassal_of = $OVERLORD$ }
					}
					trigger_else = {
						always = yes
					}
				}
			}
			trigger_else = { # High Imperial Bureaucracy+
				always = yes
			}
		}
		# Feudal/Clan/Tribal/Others rulers
		trigger_else = {
			trigger_if = { # Low Authority
				limit = {
					$OVERLORD$ = {
						OR = {
							has_realm_law = crown_authority_0
							has_realm_law = tribal_authority_0
						}
					}
				}
				trigger_if = { # Kings and above
					limit = { $OVERLORD$ = { highest_held_title_tier > tier_duchy } }
					tier_difference = {
						target = $OVERLORD$
						value <= -2
					}
				}
				NOT = { is_powerful_vassal_of = $OVERLORD$ }
			}
			trigger_else_if = { # Limited Authority
				limit = {
					$OVERLORD$ = {
						OR = {
							has_realm_law = crown_authority_1
							has_realm_law = tribal_authority_1
						}
					}
				}
				trigger_if = { # Kings and above
					limit = { $OVERLORD$ = { highest_held_title_tier > tier_duchy } }
					NOT = { is_powerful_vassal_of = $OVERLORD$ }
				}
				trigger_else = {
					always = yes
				}
			}
			trigger_else = { always = yes }
		}
	}
	# Tributaries
	trigger_else = {
		harem_politics_valid_tributary_requirements_trigger = { OVERLORD = $OVERLORD$ }
	}
}

#Grand Consort Tasks
harem_politics_grand_consort_task_valid_neighboring_ruler_trigger = {
	NOT = {
		is_tributary_of = $OVERLORD$
	}
	harem_politics_grand_consort_task_valid_basic_ruler_trigger = {
		OVERLORD = $OVERLORD$
	}
}

harem_politics_grand_consort_task_valid_vassal_trigger = {
	highest_held_title_tier >= tier_county
	harem_politics_grand_consort_task_valid_basic_ruler_trigger = {
		OVERLORD = $OVERLORD$
	}
}

harem_politics_grand_consort_task_valid_tributary_trigger = {
	trigger_if = {
		limit = {
			$OVERLORD$ = {
				government_has_flag = government_is_nomadic
			}
		}
		NOT = { is_obedient_to = $OVERLORD$ }
	}
	trigger_else = {
		trigger_if = { # Same rank tributary needs dread level 1
			limit = {
				highest_held_title_tier = $OVERLORD$.highest_held_title_tier
			}
			has_dread_level_towards = {
				target = $OVERLORD$
				level < 1
			}
		}
		trigger_else_if = { # Higher rank tributary needs dread level 2
			limit = {
				highest_held_title_tier > $OVERLORD$.highest_held_title_tier
			}
			has_dread_level_towards = {
				target = $OVERLORD$
				level < 2
			}
		}
		trigger_else = { # Low opinion check
			opinion = {
				target = $OVERLORD$
				value <= -10
			}
		}
	}
	harem_politics_grand_consort_task_valid_basic_ruler_trigger = {
		OVERLORD = $OVERLORD$
	}
}

harem_politics_grand_consort_task_valid_basic_ruler_trigger = {
	NOR = {
		has_opinion_modifier = {
			modifier = impressed_opinion
			target = $OVERLORD$
		}
		is_at_war_with = $OVERLORD$
		government_has_flag = government_is_herder
	}
	trigger_if = {
		limit = {
			NOT = {
				is_tributary_of = $OVERLORD$
			}
		}
		opinion = {
			target = $OVERLORD$
			value <= 5
		}
	}
}

# Valid neighboring counties#
harem_politics_valid_event_county_trigger = {
	trigger_if = {
		limit = {
			religion = religion:islam_religion
		}
		OR = {
			any_neighboring_and_across_water_top_liege_realm_owner = {
				OR = {
					any_realm_province = {
						NOT = {
							religion = religion:islam_religion
						}
					}
					any_tributary = {
						any_realm_province = {
							NOT = {
								religion = religion:islam_religion
							}
						}
					}
				}
			}
			any_realm_province = {
				NOT = {
					religion = religion:islam_religion
				}
			}
		}
	}	
	trigger_else = {
		NOT = {
			religion = religion:islam_religion
		}
	}
}

## Recruit concubines requirements ##
recruit_concubines_trigger = {
	is_landed_or_landless_administrative = yes
	hp_accepts_concubinage = yes
	trigger_if = {
		limit = {
			religion = religion:islam_religion
		}
		OR = {
			any_neighboring_and_across_water_top_liege_realm_owner = {
				any_realm_province = {
					religion != religion:islam_religion
				}
			}
			any_realm_province = {
				religion != religion:islam_religion
			}
		}
	}
	trigger_else = {
		OR = {
			AND = {
				government_allows = administrative
				is_independent_ruler = no
			}
			AND = {
				tgp_realm_has_ceremonial_liege_trigger = yes
				tgp_is_ceremonial_regent_trigger = yes
			}
		}
	}
	highest_held_title_tier >= tier_county
	OR = { #Appropriate dominant sex
		AND = {
			is_male = no
			OR = {
				has_realm_law = female_only_law
				has_realm_law = female_preference_law
			}
		}
		AND = {
			is_male = yes
			OR = {
				has_realm_law = male_only_law
				has_realm_law = male_preference_law
			}
		}
		has_realm_law = equal_law
	}
	trigger_if = {
		limit = {
			is_clergy = yes
		}
		faith = {
			has_doctrine_parameter = clergy_can_marry
		}
	}
}