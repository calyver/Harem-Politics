harem_politics_favored_consort_trigger = {
	OR = {
		has_character_modifier = favored_consort_modifier
		has_character_modifier = beloved_consort_modifier
		has_character_modifier = favor_boost_modifier
	}
	trigger_if = { #Can't be unfavored
		limit = { 
			has_variable = favor
		}
		trigger_if = { #Favor boost applies since neutral level
			limit = { 
				has_character_modifier = favor_boost_modifier
			}
			var:favor >= neutral_consort_lower_limit
		}
		trigger_else = {
			var:favor >= favorite_consort_lower_limit
		}
	}
	trigger_else = {
		NOT = {
			has_variable = favor
		}
	}
}

harem_politics_unfavored_consort_trigger = {
	OR = {
		has_character_modifier = unfavored_consort_modifier
		has_character_modifier = forgotten_consort_modifier
	}
	NOT = {
		has_character_modifier = favor_boost_modifier
	}
	trigger_if = { #Can't be favored
		limit = { 
			has_variable = favor
		}
		var:favor < neutral_consort_lower_limit
	}
	trigger_else = {
		NOT = {
			has_variable = favor
		}
	}
}

harem_politics_punished_consort_trigger = {
	OR = {
		has_character_flag = flag_scolded_consort
		has_character_modifier = sleep_deprived_modifier
		has_character_modifier = intrigue_starved_and_deprived_modifier
		has_character_modifier = recently_tortured
		has_character_modifier = hunt_tasted_the_belt_modifier
	}
}

accepts_harems = {
	OR = {
		accepts_polygamy = yes
		accepts_concubinage = yes
	}
}

#Favor system#
is_valid_for_favor_system_trigger = {
	is_courtier_of = $HAREM_LIEGE$
	is_alive = yes
	is_incapable = no
	OR = {
		is_imprisoned_by = $HAREM_LIEGE$
		is_imprisoned = no
	}
}

harem_politics_target_outranks_consort_trigger = {
	$CONSORT$ = {
		is_consort_of = $LIEGE$
		NOT = {
			is_parent_of = $LIEGE$
		}
	}
	$TARGET$ = {
		trigger_if = { #They're liege's parent
			limit = {
				is_parent_of = $LIEGE$
			}
		}
		trigger_else_if = { #They're the primary spouse
			limit = {
				exists = $LIEGE$.primary_spouse
				this = $LIEGE$.primary_spouse
			}
		}
		trigger_else_if = { #They're the Grand Consort
			limit = {
				has_court_position = grand_consort_court_position
			}
			$CONSORT$ = {
				trigger_if = { #They can't be the PS
					limit = {
						exists = $LIEGE$.primary_spouse
					}
					NOT = {
						this = $LIEGE$.primary_spouse
					}
				}
			}
		}
		trigger_else = {
			trigger_if = {
				limit = {
					is_spouse_of = $LIEGE$
				}
				$CONSORT$ = {
					is_concubine_of = $LIEGE$
				}
			}
		}
	}
}

harem_politics_eligible_bride_show_candidate_trigger = {
	is_healthy = yes
	is_married = no
	is_concubine = no
	is_imprisoned = no
	OR = {
		AND = { #If they aren't betrothed, you can arrange a marriage with them
			age = 15
			exists = betrothed
			$LIEGE$ = {
				is_ai = no
			}
		}
		age >= 16
	}
	age <= 22
	NOR = {
		AND = { #If you betrothed them already, why should they participate?
			exists = betrothed
			betrothed = { is_close_family_of = $LIEGE$ }
		}
		has_council_position = councillor_court_chaplain
		is_close_family_of = $LIEGE$
		has_trait = devoted
		has_trait = celibate
		has_trait = lunatic_1
		has_trait = lunatic_genetic
		has_trait = possessed_1
		has_trait = possessed_genetic
		has_trait = lisping
		has_trait = stuttering
		has_trait = scaly
		has_trait = clubfooted
		has_trait = hunchbacked
		has_trait = wheezing
		has_trait = spindly
		has_trait = one_eyed
		has_trait = one_legged
		has_trait = disfigured
		has_trait = eunuch
		has_trait = adulterer
		has_trait = fornicator
		has_trait = deviant
		has_trait = murderer
		has_trait = kinslayer_1
		has_trait = kinslayer_2
		has_trait = kinslayer_3
		has_trait = incestuous
		has_trait = excommunicated
		has_trait = drunkard
		has_trait = hashishiyah
		has_trait = wounded
		has_trait = sickly
		has_trait = infirm
		has_trait = incapable
		has_trait = inbred
		has_trait = maimed
		has_trait = blind
		has_trait = ill
		has_trait = bubonic_plague
		has_trait = cancer
		has_trait = consumption
		has_trait = great_pox
		has_trait = gout_ridden
		has_trait = leper
		has_trait = lovers_pox
		has_trait = pneumonic
		has_trait = smallpox
		has_trait = typhus
		has_trait = dwarf
		has_trait = physique_bad_3	#Weak candidates wouln't make it to the capital without getting sick.
		
		has_trait = dysentery
		has_trait = ergotism
		has_trait = measles

		has_trait = pregnant

		has_trait = beauty_bad
		has_trait = intellect_bad
	}
	can_take_as_concubine_character_trigger = { CHARACTER = $LIEGE$ }
	NOT = {
		any_heir_title = {
			place_in_line_of_succession = {
				target = prev
				value <= 2
			}
		}
	}
}

harem_politics_valid_bride_show_subject_trigger = {
	NOR = {	
		is_at_war_with = $OVERLORD$
		government_has_flag = government_is_theocracy
		government_has_flag = government_is_republic
		government_has_flag = government_is_herder
		any_close_family_member = { #You can't make demands to the imperial family
			is_liege_or_above_of = $OVERLORD$
		}
		has_opinion_modifier = {
			modifier = demanded_concubine_opinion
			target = $OVERLORD$
		}
	}
	is_imprisoned = no
	trigger_if = { #Tributary requirements
		limit = {
			NOT = {
				is_vassal_of = $OVERLORD$
			}
		}
		trigger_if = { #For a nomad's tributaries, what matters it their obedience.
			limit = {
				$OVERLORD$ = {	
					government_has_flag = government_is_nomadic
				}
			}
			is_obedient_to = $OVERLORD$
		}
		trigger_else_if = { #Else, if they rank the same as their suzerain, they need to dread them
			limit = {
				highest_held_title_tier = $OVERLORD$.highest_held_title_tier
			}
			OR = {
				has_dread_level_towards = {
					target = $OVERLORD$
					level >= 1
				}
				opinion = {
					target = $OVERLORD$
					value >= 15
				}
			}
		}
		trigger_else_if = { #Else, they need to dread them more
			limit = {
				highest_held_title_tier > $OVERLORD$.highest_held_title_tier
			}
			OR = {
				has_dread_level_towards = {
					target = $OVERLORD$
					level >= 2
				}
				opinion = {
					target = $OVERLORD$
					value >= 30
				}
			}
		}
		trigger_else = { #Or nothing :)
			always = yes
		}
	}
}