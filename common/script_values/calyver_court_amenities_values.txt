####################
## Harem Politics ##
####################

## Fashion ##
harem_politics_fashion_cost = {
	value = 1
	#Primary spouse
	if = {
		limit = {
			primary_spouse ?= {
				is_landed = no
				is_physically_able = yes
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Greedy, arrogant and ambitious spouses will spend more
		if = {
			limit = {
				primary_spouse = {
					has_trait = greedy
				}
			}
			multiply =  1.10
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = arrogant
				}
			}
			multiply =  1.15
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = ambitious
				}
			}
			multiply =  1.10
		}
		#Lazy, humble, and content spouses will spend less on their attire
		if = {
			limit = {
				primary_spouse = {
					has_trait = lazy
				}
			}
			multiply =  0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = humble
				}
			}
			multiply =  0.85
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = content
				}
			}
			multiply =  0.85
		}
	}
	
	#Grand Consort
	if = {
		limit = {
			any_court_position_holder = {
				type = grand_consort_court_position
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Greedy, arrogant and ambitious spouses will spend more
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = greedy
				}
			}
			multiply =  1.05
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = arrogant
				}
			}
			multiply =  1.10
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = ambitious
				}
			}
			multiply =  1.05
		}
		#Lazy, humble, and content spouses will spend less on their attire
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = lazy
				}
			}
			multiply =  0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = humble
				}
			}
			multiply =  0.90
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = content
				}
			}
			multiply =  0.90
		}
	}
}

## Food Quality ##
harem_politics_food_quality_cost = {
	value = 1
	#Primary spouse
	if = {
		limit = {
			primary_spouse ?= {
				is_landed = no
				is_physically_able = yes
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Foodies, generous, and gregarious spouses will spend more
		if = {
			limit = {
				primary_spouse = {
					has_trait = gluttonous
				}
			}
			multiply = 1.15
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = gregarious
				}
			}
			multiply =  1.05
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = generous
				}
			}
			multiply = 1.05
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = comfort_eater
				}
			}
			multiply = 1.15
		}
		#Content, greedy, and temperate spouses will spend less
		if = {
			limit = {
				primary_spouse = {
					has_trait = content
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = greedy
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = temperate
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = inappetetic
				}
			}
			multiply = 0.85
		}
	}
	
	#Grand Consort
	if = {
		limit = {
			any_court_position_holder = {
				type = grand_consort_court_position
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Foodies, generous, and gregarious spouses will spend more
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = gluttonous
				}
			}
			multiply = 1.10
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = gregarious
				}
			}
			multiply =  1.025
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = generous
				}
			}
			multiply = 1.025
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = comfort_eater
				}
			}
			multiply = 1.10
		}
		#Content, greedy, and temperate spouses will spend less
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = content
				}
			}
			multiply = 0.975
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = greedy
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = temperate
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = inappetetic
				}
			}
			multiply = 0.90
		}
	}
}

## Lodging Standards ##
harem_politics_lodging_standards_cost = {
	value = 1
	#Primary spouse
	if = {
		limit = {
			primary_spouse ?= {
				is_landed = no
				is_physically_able = yes
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Generous, gregarious, ambitious, greedy and arrogant spouses will spend more on lodging
		if = {
			limit = {
				primary_spouse = {
					has_trait = gregarious
				}
			}
			multiply = 1.05
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = greedy
				}
			}
			multiply = 1.05
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = generous
				}
			}
			multiply = 1.15
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = arrogant
				}
			}
			multiply = 1.10
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = ambitious
				}
			}
			multiply = 1.05
		}
		#Content, diligent, and humble spouses will spend less
		if = {
			limit = {
				primary_spouse = {
					has_trait = content
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = humble
				}
			}
			multiply = 0.80
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = diligent
				}
			}
			multiply = 0.90
		}
	}
	
	#Grand Consort
	if = {
		limit = {
			any_court_position_holder = {
				type = grand_consort_court_position
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Generous, gregarious, ambitious, greedy and arrogant spouses will spend more on lodging
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = gregarious
				}
			}
			multiply = 1.025
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = greedy
				}
			}
			multiply = 1.025
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = generous
				}
			}
			multiply = 1.10
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = arrogant
				}
			}
			multiply = 1.05
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = ambitious
				}
			}
			multiply = 1.025
		}
		#Content, diligent, and humble spouses will spend less
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = content
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = humble
				}
			}
			multiply = 0.85
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = diligent
				}
			}
			multiply = 0.95
		}
	}
}

## Court Servants ##
harem_politics_court_servants_cost = {
	value = 1
	#Primary spouse
	if = {
		limit = {
			primary_spouse ?= {
				is_landed = no
				is_physically_able = yes
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Generous, arrogant and improvident spouses will spend more on their servants
		if = {
			limit = {
				primary_spouse = {
					has_trait = generous
				}
			}
			multiply = 1.15
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = arrogant
				}
			}
			multiply = 1.10
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = improvident
				}
			}
			multiply = 1.10
		}
		#Diligent, greedy, humble, temperate and content spouses will spend less
		if = {
			limit = {
				primary_spouse = {
					has_trait = diligent
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = greedy
				}
			}
			multiply = 0.85
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = humble
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = temperate
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = content
				}
			}
			multiply = 0.95
		}
	}
	
	#Grand Consort
	if = {
		limit = {
			any_court_position_holder = {
				type = grand_consort_court_position
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Generous, arrogant and improvident spouses will spend more on their servants
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = generous
				}
			}
			multiply = 1.10
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = arrogant
				}
			}
			multiply = 1.05
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = improvident
				}
			}
			multiply = 1.05
		}
		#Diligent, greedy, humble, temperate and content spouses will spend less
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = diligent
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = greedy
				}
			}
			multiply = 0.90
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = humble
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = temperate
				}
			}
			multiply = 0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = content
				}
			}
			multiply = 0.97
		}
	}
}

#############
## Vanilla ##
#############

## Base ##
base_court_amenities_cost = {
	value = sub_realm_size
	divide = {
		add = 4
		subtract = {
			add = 0.25
			multiply = court_grandeur_current_level
		}
	}
	if = { # Add a baseline depending on rank
		limit = {
			highest_held_title_tier >= tier_empire
		}
		add = 20
	}
	else = {
		add = 10
	}
	#Harem Politics modifiers
	if = {
		limit = {
			primary_spouse ?= {
				is_landed = no
				is_physically_able = yes
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Stewardship
		if = {
			limit = {
				primary_spouse = {
					stewardship <= mediocre_skill_rating
				}
			}
			multiply =  1.20
		}
		else_if = {
			limit = {
				primary_spouse = {
					stewardship >= very_high_skill_rating
				}
			}
			multiply =  0.85
		}
		else_if = {
			limit = {
				primary_spouse = {
					stewardship >= high_skill_rating
				}
			}
			multiply =  0.90
		}
		
		#Traits
		if = {
			limit = {
				primary_spouse = {
					has_trait = diligent
				}
			}
			multiply =  0.95
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = temperate
				}
			}
			multiply =  0.95
		}
		if = {
			limit = {
				primary_spouse = {
					has_trait = lazy
				}
			}
			multiply =  1.10
		}
		
		#Traits
		if = {
			limit = {
				primary_spouse = {
					has_trait = intellect_good_1
				}
			}
			multiply =  0.97
		}
		else_if = {
			limit = {
				primary_spouse = {
					has_trait = intellect_good_2
				}
			}
			multiply =  0.95
		}
		else_if = {
			limit = {
				primary_spouse = {
					has_trait = intellect_good_3
				}
			}
			multiply =  0.92
		}
		
		#Traits
		if = {
			limit = {
				primary_spouse = {
					has_trait = intellect_bad_1
				}
			}
			multiply =  1.02
		}
		else_if = {
			limit = {
				primary_spouse = {
					has_trait = intellect_bad_2
				}
			}
			multiply =  1.05
		}
		else_if = {
			limit = {
				primary_spouse = {
					has_trait = intellect_bad_3
				}
			}
			multiply =  1.07
		}

		#Coping
		if = {
			limit = {
				primary_spouse = {
					has_trait = profligate
				}
			}
			multiply =  1.10
		}
	}
	
	if = {
		limit = {
			any_court_position_holder = {
				type = grand_consort_court_position
				hp_accepts_harems = yes
				NOT = {
					has_opinion_modifier = {
						modifier = forced_me_concubine_marriage_opinion
						target = root
					}
				}
			}
		}
		#Stewardship
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					stewardship <= mediocre_skill_rating
				}
			}
			multiply =  1.10
		}
		else_if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					stewardship >= very_high_skill_rating
				}
			}
			multiply =  0.90
		}
		else_if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					stewardship >= high_skill_rating
				}
			}
			multiply =  0.95
		}
		
		#Traits
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = diligent
				}
			}
			multiply =  0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = temperate
				}
			}
			multiply =  0.95
		}
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = lazy
				}
			}
			multiply =  1.05
		}
		
		#Traits
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = intellect_good_1
				}
			}
			multiply =  0.95
		}
		else_if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = intellect_good_2
				}
			}
			multiply =  0.90
		}
		else_if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = intellect_good_3
				}
			}
			multiply =  0.85
		}
		
		#Traits
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = intellect_bad_1
				}
			}
			multiply =  1.05
		}
		else_if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = intellect_bad_2
				}
			}
			multiply =  1.10
		}
		else_if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = intellect_bad_3
				}
			}
			multiply =  1.15
		}

		#Coping
		if = {
			limit = {
				any_court_position_holder = {
					type = grand_consort_court_position
					has_trait = profligate
				}
			}
			multiply =  1.05
		}
	}
	#Vanilla
	if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_late_medieval
			}
		}
		multiply =  {
			value =  1.75
		}
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_high_medieval
			}
		}
		multiply = {
			value = 1.5
		}
	}
	else_if = {
		limit = {
			culture = {
				has_cultural_era_or_later = culture_era_early_medieval
			}
		}
		multiply = {
			value = 1.25
		} 
	}
	if = {
		limit = {
			has_game_rule = hard_difficulty
			is_ai = yes
		}
		multiply = 0.75
	}
	else_if = {
		limit = {
			has_game_rule = very_hard_difficulty
			is_ai = yes
		}
		multiply = 0.5
	}
}

## Cost level 1 ##
# Fashion
court_amenities_cost_level_1_fashion = {
	value = court_amenities_cost_level_1
	multiply = harem_politics_fashion_cost
	if = {
		limit = {
			has_character_flag = court_free_fashion
		}
		min = 0
		multiply = 0
	}
}
# Food
court_amenities_cost_level_1_food = {
	value = court_amenities_cost_level_1
	multiply = harem_politics_food_quality_cost
	if = {
		limit = {
			has_character_modifier = rivers_of_wine_modifier
		}
		multiply = 0.5
	}
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_food_taster_2_modifier
				has_character_modifier = employer_booner_food_taster_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Lodgings
court_amenities_cost_level_1_lodgings = {
	value = court_amenities_cost_level_1
	multiply = harem_politics_lodging_standards_cost
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_seneschal_2_modifier
				has_character_modifier = employer_booner_seneschal_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Servants
court_amenities_cost_level_1_servants = {
	value = court_amenities_cost_level_1
	multiply = harem_politics_court_servants_cost
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_cupbearer_2_modifier
				has_character_modifier = employer_booner_cupbearer_3_modifier
			}
		}
		multiply = 0.75
	}
}

## Cost level 2 ##
# Fashion
court_amenities_cost_level_2_fashion = {
	value = court_amenities_cost_level_2
	multiply = harem_politics_fashion_cost
	if = {
		limit = {
			has_character_flag = court_cheaper_fashion
		}
		multiply = 0.8
	}
}
# Food
court_amenities_cost_level_2_food = {
	value = court_amenities_cost_level_2
	multiply = harem_politics_food_quality_cost
	if = {
		limit = {
			has_character_flag = court_cheaper_food
		}
		multiply = 0.8
	}
	if = {
		limit = {
			has_character_modifier = rivers_of_wine_modifier
		}
		multiply = 0.5
	}
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_food_taster_2_modifier
				has_character_modifier = employer_booner_food_taster_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Lodgings
court_amenities_cost_level_2_lodgings = {
	value = court_amenities_cost_level_2
	multiply = harem_politics_lodging_standards_cost
	if = {
		limit = {
			has_character_modifier = lodgings_epidemics_resistance_modifier_1
		}
		multiply = 0.85
	}
	if = {
		limit = {
			has_character_modifier = lodgings_epidemics_resistance_modifier_2
		}
		multiply = 0.75
	}
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_seneschal_2_modifier
				has_character_modifier = employer_booner_seneschal_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Servants
court_amenities_cost_level_2_servants = {
	value = court_amenities_cost_level_2
	multiply = harem_politics_court_servants_cost
	if = {
		limit = {
			has_character_flag = court_cheaper_servants
		}
		multiply = 0.8
	}
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_cupbearer_2_modifier
				has_character_modifier = employer_booner_cupbearer_3_modifier
			}
		}
		multiply = 0.75
	}
}

## Cost level 3 ##
# Fashion
court_fashion_good_cost = {
	value = court_amenities_cost_level_3
	multiply = harem_politics_fashion_cost

	if = {
		limit = {
			culture = { has_cultural_parameter = reduces_court_fashion_costs_parameter }
		}
		multiply = 0.5
	}
}
# Food
court_amenities_cost_level_3_food = {
	value = court_amenities_cost_level_3
	multiply = harem_politics_food_quality_cost
	if = {
		limit = {
			has_character_modifier = rivers_of_wine_modifier
		}
		multiply = 0.5
	}
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_food_taster_2_modifier
				has_character_modifier = employer_booner_food_taster_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Lodgings
court_amenities_cost_level_3_lodgings = {
	value = court_amenities_cost_level_3
	multiply = harem_politics_lodging_standards_cost
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_seneschal_2_modifier
				has_character_modifier = employer_booner_seneschal_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Servants
court_amenities_cost_level_3_servants = {
	value = court_amenities_cost_level_3
	multiply = harem_politics_court_servants_cost
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_cupbearer_2_modifier
				has_character_modifier = employer_booner_cupbearer_3_modifier
			}
		}
		multiply = 0.75
	}
}

## Cost level 4 ##
# Fashion
court_fashion_fantastic_cost = {
	value = court_amenities_cost_level_4
	multiply = harem_politics_fashion_cost

	if = {
		limit = {
			culture = { has_cultural_parameter = reduces_court_fashion_costs_parameter }
		}
		multiply = 0.5
	}
}
# Food
court_amenities_cost_level_4_food = {
	value = court_amenities_cost_level_4
	multiply = harem_politics_food_quality_cost
	if = {
		limit = {
			has_character_modifier = rivers_of_wine_modifier
		}
		multiply = 0.5
	}
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_food_taster_2_modifier
				has_character_modifier = employer_booner_food_taster_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Lodgings
court_amenities_cost_level_4_lodgings = {
	value = court_amenities_cost_level_4
	multiply = harem_politics_lodging_standards_cost
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_seneschal_2_modifier
				has_character_modifier = employer_booner_seneschal_3_modifier
			}
		}
		multiply = 0.75
	}
}
# Servants
court_amenities_cost_level_4_servants = {
	value = court_amenities_cost_level_4
	multiply = harem_politics_court_servants_cost
	if = {
		limit = {
			OR = {
				has_character_modifier = employer_booner_cupbearer_2_modifier
				has_character_modifier = employer_booner_cupbearer_3_modifier
			}
		}
		multiply = 0.75
	}
}