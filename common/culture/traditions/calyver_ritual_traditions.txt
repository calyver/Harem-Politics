##############################
# RITUAL CULTURAL TRADITIONS #
##############################

tradition_monogamous = {
	category = ritual

	layers = {
		0 = learning
		1 = western
		4 = knight.dds
	}
	
	can_pick = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			trigger_if = {
				limit = {
					OR = {
						NOT = { exists = scope:replacing }
						NOR = {
							scope:replacing = culture_tradition:tradition_polygamous
							scope:replacing = culture_tradition:tradition_concubines
							scope:replacing = culture_tradition:tradition_harem
							scope:replacing = culture_tradition:tradition_tgp_court_machinations
						}
					}
				}
				NOR = {
					culture_tradition:tradition_polygamous = { is_in_list = traits }
					culture_tradition:tradition_concubines = { is_in_list = traits }
					culture_tradition:tradition_harem = { is_in_list = traits }
					culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
				}
			}
		}
	}
	can_pick_for_hybridization = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			NOR = {
				culture_tradition:tradition_polygamous = { is_in_list = traits }
				culture_tradition:tradition_concubines = { is_in_list = traits }
				culture_tradition:tradition_harem = { is_in_list = traits }
				culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
			}
		}
	}
	
	parameters = {
		number_of_spouses = 1
		romance_scheme_bonus_vs_spouse = yes
	}
	
	character_modifier = {
		spouse_opinion = 10
	}
	
	cost = {
		prestige = {
			add = {
				value = tradition_base_cost
				desc = BASE
				format = "BASE_VALUE_FORMAT"
			}
			if = {
				limit = {
					scope:character.faith = {
						OR = {
							has_doctrine_parameter = allows_polygamy
							has_doctrine_parameter = allows_concubinage
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = cheaper_tradition_from_faith
				}
			}

			if = {
				limit = {
					culture_tradition_reduction_trigger = { TRADITION = tradition_monogamous }
				}
				multiply = {
					value = 0.5
					desc = inspired_by_culture_desc
				}
			}
			
			multiply = tradition_replacement_cost_if_relevant
		}
	}
	
	ai_will_do = { value = 0 }
}

tradition_polygamous = {
	category = ritual

	layers = {
		0 = diplo
		1 = mena
		4 = temple.dds
	}
	
	can_pick = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			trigger_if = {
				limit = {
					OR = {
						NOT = { exists = scope:replacing }
						NOR = {
							scope:replacing = culture_tradition:tradition_monogamous
							scope:replacing = culture_tradition:tradition_concubines
							scope:replacing = culture_tradition:tradition_harem
							scope:replacing = culture_tradition:tradition_tgp_court_machinations
						}
					}
				}
				NOR = {
					culture_tradition:tradition_monogamous = { is_in_list = traits }
					culture_tradition:tradition_concubines = { is_in_list = traits }
					culture_tradition:tradition_harem = { is_in_list = traits }
					culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
				}
			}
		}
	}
	can_pick_for_hybridization = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			NOR = {
				culture_tradition:tradition_monogamous = { is_in_list = traits }
				culture_tradition:tradition_concubines = { is_in_list = traits }
				culture_tradition:tradition_harem = { is_in_list = traits }
				culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
			}
		}
	}
	
	parameters = {
		number_of_spouses = 4
		allows_polygamy = yes
	}
	
	cost = {
		prestige = {
			add = {
				value = tradition_double_base_cost
				desc = BASE
				format = "BASE_VALUE_FORMAT"
			}
			if = {
				limit = {
					scope:character.faith = {
						NOR = {
							has_doctrine_parameter = allows_polygamy
							has_doctrine_parameter = allows_concubinage
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = cheaper_tradition_from_faith
				}
			}

			if = {
				limit = {
					culture_tradition_reduction_trigger = { TRADITION = tradition_polygamous }
				}
				multiply = {
					value = 0.5
					desc = inspired_by_culture_desc
				}
			}
			
			multiply = tradition_replacement_cost_if_relevant
		}
	}
	
	ai_will_do = { value = 0 }
}

tradition_concubines = {
	category = ritual

	layers = {
		0 = intrigue
		1 = indian
		4 = greeting.dds
	}
	
	can_pick = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			trigger_if = {
				limit = {
					OR = {
						NOT = { exists = scope:replacing }
						NOR = {
							scope:replacing = culture_tradition:tradition_monogamous
							scope:replacing = culture_tradition:tradition_polygamous
							scope:replacing = culture_tradition:tradition_harem
							scope:replacing = culture_tradition:tradition_tgp_court_machinations
						}
					}
				}
				NOR = {
					culture_tradition:tradition_monogamous = { is_in_list = traits }
					culture_tradition:tradition_polygamous = { is_in_list = traits }
					culture_tradition:tradition_harem = { is_in_list = traits }
					culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
				}
			}
		}
	}
	can_pick_for_hybridization = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			NOR = {
				culture_tradition:tradition_monogamous = { is_in_list = traits }
				culture_tradition:tradition_polygamous = { is_in_list = traits }
				culture_tradition:tradition_harem = { is_in_list = traits }
				culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
			}
		}
	}
	
	parameters = {
		number_of_spouses = 1
		number_of_consorts = 3

		number_of_consorts_hegemony = 5
		allows_concubinage = yes
	}
	
	cost = {
		prestige = {
			add = {
				value = tradition_double_base_cost
				desc = BASE
				format = "BASE_VALUE_FORMAT"
			}
			if = {
				limit = {
					NOT = {
						scope:character.faith = {
							OR = {
								has_doctrine_parameter = allows_polygamy
								has_doctrine_parameter = allows_concubinage
							}
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = cheaper_tradition_from_faith
				}
			}

			if = {
				limit = {
					culture_tradition_reduction_trigger = { TRADITION = tradition_concubines }
				}
				multiply = {
					value = 0.5
					desc = inspired_by_culture_desc
				}
			}
			
			multiply = tradition_replacement_cost_if_relevant
		}
	}
	
	ai_will_do = { value = 0 }
}

## Harem Politics ##
tradition_harem = {
	category = ritual

	layers = {
		0 = intrigue
		1 = mena
		4 = greeting.dds
	}
	can_pick = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			trigger_if = {
				limit = {
					OR = {
						NOT = { exists = scope:replacing }
						NOR = {
							scope:replacing = culture_tradition:tradition_monogamous
							scope:replacing = culture_tradition:tradition_polygamous
							scope:replacing = culture_tradition:tradition_concubines
							scope:replacing = culture_tradition:tradition_tgp_court_machinations
						}
					}
				}
				NOR = {
					culture_tradition:tradition_monogamous = { is_in_list = traits }
					culture_tradition:tradition_polygamous = { is_in_list = traits }
					culture_tradition:tradition_concubines = { is_in_list = traits }
					culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
				}
			}
		}
	}
	can_pick_for_hybridization = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			NOR = {
				culture_tradition:tradition_monogamous = { is_in_list = traits }
				culture_tradition:tradition_polygamous = { is_in_list = traits }
				culture_tradition:tradition_concubines = { is_in_list = traits }
				culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
			}
		}
	}
	
	parameters = {
		number_of_spouses = 4
		number_of_consorts = 5

		number_of_consorts_hegemony = 20
		allows_polygamy = yes
		allows_concubinage = yes
	}
	
	cost = {
		prestige = {
			add = {
				value = tradition_double_base_cost
				desc = BASE
				format = "BASE_VALUE_FORMAT"
			}
			if = {
				limit = {
					NOT = {
						scope:character.faith = {
							OR = {
								has_doctrine_parameter = allows_polygamy
								has_doctrine_parameter = allows_concubinage
							}
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = cheaper_tradition_from_faith
				}
			}

			if = {
				limit = {
					culture_tradition_reduction_trigger = { TRADITION = tradition_harem }
				}
				multiply = {
					value = 0.5
					desc = inspired_by_culture_desc
				}
			}

			multiply = tradition_replacement_cost_if_relevant
		}
	}
	
	ai_will_do = { value = 0 }
}

tradition_magnificent_courts = {
	category = realm

	layers = {
		0 = intrigue
		1 = mediterranean
		4 = ceremony.dds
	}

	can_pick = {
		custom_tooltip = {
			text = cannot_have_tradition_byzantine_succession
			NOR = { 
				culture_tradition:tradition_byzantine_succession = { is_in_list = traits } 
				culture_tradition:tradition_court_eunuchs = { is_in_list = traits } 
			}
		}
		custom_tooltip = {
			text = cannot_combine_with_eunuch_traditions
			NOR = { 
				culture_tradition:tradition_court_eunuchs = { is_in_list = traits }
				culture_tradition:tradition_byzantine_succession = { is_in_list = traits }
				culture_tradition:tradition_ep3_palace_politics = { is_in_list = traits }
				culture_tradition:tradition_tgp_court_machinations = { is_in_list = traits }
			}
		}
		custom_tooltip = {
			scope:character = {
				OR = {
					any_courtier = { is_eunuch_trigger = yes }
					any_vassal = { is_eunuch_trigger = yes }
					any_councillor = { is_eunuch_trigger = yes }
				}
			}
			text = no_eunuch_in_realms
		}
	}
	
	parameters = {
		can_castrate_prisoners = yes
		eunuch_trait_bonuses = yes
		can_appoint_chief_eunuch = yes
	}

	cost = {
		prestige = {
			add = {
				value = tradition_base_cost
				desc = BASE
				format = "BASE_VALUE_FORMAT"
			}
			if = {
				limit = {
					NOR = {
						culture_pillar:ethos_courtly = { is_in_list = traits }
						culture_pillar:ethos_communal = { is_in_list = traits }
						culture_pillar:ethos_spiritual = { is_in_list = traits }
					}
				}
				add = {
					value = tradition_incompatible_ethos_penalty
					desc = not_courtly_communal_or_spiritual_desc
				}
			}
			if = {
				limit = {
					NOT = {
						scope:character = {
							any_councillor = { is_eunuch_trigger = yes }
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = no_eunuch_councillors_desc
				}
			}

			if = {
				limit = {
					culture_tradition_reduction_trigger = { TRADITION = tradition_court_eunuchs }
				}
				multiply = {
					value = 0.5
					desc = inspired_by_culture_desc
				}
			}
			
			multiply = tradition_replacement_cost_if_relevant
		}
	}

	ai_will_do = {
		value = 200
		if = {
			limit = {
				scope:character.religion != religion:islam_religion
			}
			multiply = 0
		}
	}
}

## Vanilla - AUH ##
tradition_tgp_court_machinations = {
	category = regional

	layers = {
		0 = intrigue
		1 = indian
		4 = officials.dds
	}

	is_shown = {
		has_tgp_dlc_trigger = yes
		has_settled_harem_trigger  = yes
	}
	can_pick = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			trigger_if = {
				limit = {
					OR = {
						NOT = { exists = scope:replacing }
						NOR = {
							scope:replacing = culture_tradition:tradition_monogamous
							scope:replacing = culture_tradition:tradition_polygamous
							scope:replacing = culture_tradition:tradition_concubines
							scope:replacing = culture_tradition:tradition_harem
							scope:replacing = culture_tradition:tradition_court_eunuchs
						}
					}
				}
				NOR = {
					culture_tradition:tradition_monogamous = { is_in_list = traits }
					culture_tradition:tradition_polygamous = { is_in_list = traits }
					culture_tradition:tradition_concubines = { is_in_list = traits }
					culture_tradition:tradition_harem = { is_in_list = traits }
				}
			}
		}
		custom_tooltip = {
			text = cannot_combine_with_eunuch_traditions
			NOR = { 
				culture_tradition:tradition_court_eunuchs = { is_in_list = traits }
				culture_tradition:tradition_byzantine_succession = { is_in_list = traits }
				culture_tradition:tradition_ep3_palace_politics = { is_in_list = traits }
				culture_tradition:tradition_magnificent_courts = { is_in_list = traits }
			}
		}
	}
	
	can_pick_for_hybridization = {
		custom_tooltip = {
			text = only_one_marriage_tradition_allowed
			NOR = {
				culture_tradition:tradition_monogamous = { is_in_list = traits }
				culture_tradition:tradition_polygamous = { is_in_list = traits }
				culture_tradition:tradition_concubines = { is_in_list = traits }
				culture_tradition:tradition_harem = { is_in_list = traits }
			}
		}
	}

	parameters = {
		number_of_consorts_hegemony = 20
		number_of_consorts = 3
		number_of_spouses = 1
		can_appoint_chief_eunuch = yes
		court_machinations_eunuch_trait_bonuses = yes
		courtiers_more_likely_to_join_hostile_schemes_in_court = yes
		eunuch_powerful_scheme_agents = yes 
		cultrad_unlocks_t4_bounties_for_whispers = yes

		allows_concubinage = yes
	}

	character_modifier = {
		owned_political_scheme_success_chance_add = 10
	}
	
	cost = {
		prestige = {
			add = {
				value = tradition_double_base_cost
				desc = BASE
				format = "BASE_VALUE_FORMAT"
			}
			if = {
				limit = {
					NOR = {
						culture_pillar:ethos_bureaucratic = { is_in_list = traits }
						culture_pillar:ethos_courtly = { is_in_list = traits }
						culture_pillar:ethos_spiritual = { is_in_list = traits }
					}
				}
				add = {
					value = tradition_incompatible_ethos_penalty
					desc = not_bureaucratic_courtly_or_spiritual_desc
				}
			}
			if = {
				limit = {
					has_dlc_feature = royal_court
					OR = {
						scope:character = { has_royal_court = no }
						NOT = {
							scope:character = {
								court_grandeur_current_level >= very_high_court_grandeur_level
							}
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = culture_head_court_grandeur_desc
				}
			}
			if = {
				limit = {
					NOT = {
						scope:character.faith = {
							OR = {
								has_doctrine_parameter = allows_polygamy
								has_doctrine_parameter = allows_concubinage
							}
						}
					}
				}
				add = {
					value = tradition_unfulfilled_criteria_penalty
					desc = cheaper_tradition_from_faith
				}
			}
			
			multiply = tradition_replacement_cost_if_relevant
		}
	}
	
	ai_will_do = {
		value = 200
		if = {
			limit = { # Admin should be more into this
				scope:character = {
					government_allows = administrative
				}
			}
			multiply = 2
		}
	}
}
