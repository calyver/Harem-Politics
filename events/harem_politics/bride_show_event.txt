namespace = bride_show

scripted_trigger agrees_with_bride_show = {
	OR = {
		culture = { has_cultural_pillar = heritage_east_slavic }
		culture = { has_cultural_tradition = tradition_ep3_palace_politics }
		culture = { has_cultural_tradition = tradition_legalistic }
		accepts_concubinage = yes
		accepts_polygamy = yes
	}
}

scripted_trigger bride_show_viable_candidate_trigger = {
	is_healthy = yes
	is_married = no
	is_concubine = no
	is_imprisoned = no
	OR = {
		AND = { #If they aren't betrothed, you can arrange a marriage with them
			age = 15
			exists = betrothed
			root = {
				is_ai = no
			}
		}
		age >= 16
	}
	age <= 22
	NOR = {
		AND = { #If you betrothed them already, why should they participate?
			exists = betrothed
			betrothed = { is_close_family_of = root }
		}
		has_council_position = councillor_court_chaplain
		is_close_family_of = root
		has_trait = devoted
		has_trait = celibate
		has_trait = lunatic_1
		has_trait = lunatic_genetic
		has_trait = possessed_1
		has_trait = possessed_genetic
		has_trait = lisping
		has_trait = stuttering
		has_trait = scaly
		has_trait = clubfooted
		has_trait = hunchbacked
		has_trait = wheezing
		has_trait = spindly
		has_trait = one_eyed
		has_trait = one_legged
		has_trait = disfigured
		has_trait = eunuch
		has_trait = adulterer
		has_trait = fornicator
		has_trait = deviant
		has_trait = murderer
		has_trait = kinslayer_1
		has_trait = kinslayer_2
		has_trait = kinslayer_3
		has_trait = incestuous
		has_trait = excommunicated
		has_trait = drunkard
		has_trait = hashishiyah
		has_trait = wounded
		has_trait = sickly
		has_trait = infirm
		has_trait = incapable
		has_trait = inbred
		has_trait = maimed
		has_trait = blind
		has_trait = ill
		has_trait = bubonic_plague
		has_trait = cancer
		has_trait = consumption
		has_trait = great_pox
		has_trait = gout_ridden
		has_trait = leper
		has_trait = lovers_pox
		has_trait = pneumonic
		has_trait = smallpox
		has_trait = typhus
		has_trait = dwarf
		has_trait = physique_bad_3	#Weak candidates wouln't make it to the capital without getting sick.
		
		has_trait = dysentery
		has_trait = ergotism
		has_trait = measles

		has_trait = pregnant
	}
	OR = { #Beauty parameters
		AND = { #Beauty matters
			NOT = { 
				has_trait = beauty_bad
			}
			exists = local_var:beauty_important
		}
		NOT = { 
			exists = local_var:beauty_important
		}
	}
	OR = { #Intellect parameters
		AND = { #Intellect matters
			NOT = { 
				has_trait = intellect_bad
			}
			exists = local_var:personality_skills_important
		}
		NOT = { 
			exists = local_var:personality_skills_important
		}
	}
	can_take_as_concubine_character_trigger = { CHARACTER = root }
	NOT = {
		any_heir_title = {
			place_in_line_of_succession = {
				target = prev
				value <= 2
			}
		}
	}
}

scripted_trigger can_have_four_candidates_trigger = {
	OR = {
		highest_held_title_tier = tier_empire
		any_vassal = {
			count >= 9
		}
	}
}

scripted_effect bride_show_add_to_candidate_list_effect = {
	if = {
		limit = { bride_show_viable_candidate_trigger = yes }
		add_to_list = elegible_candidates
	}
}

scripted_effect bride_show_next_candidate_effect = {
	if = {
		limit = { #I can still pick dates
			OR = {
				NOT = {		
					exists = scope:candidate_3
				}
				AND = {	
					NOT = {		
						exists = scope:candidate_4
					}
					can_have_four_candidates_trigger = yes
				}
			}
		}
		#Characters will be created only if not at least 4 candidates
		if = {
			limit = { 
				OR = { 
					any_in_list = {
						list = elegible_candidates
						count = 0
					}
					any_in_list = { #Or in case all of them are teens
						list = elegible_candidates
						is_adult = no
						count >= 3
					}
				}
			}
			if = {
				limit = { is_male = yes }
				create_character = {
					location = root.capital_province
					template = potential_bride_character
					gender = female
					after_creation = {
						#Good genetics
						random = {
							chance = 100
							random_list = {
								2 = { # Good genetics
									modifier = { #Emperors
										add = 3
										root = {
											highest_held_title_tier = tier_empire
										}
									}
									modifier = { #Kings
										add = 2
										root = {
											highest_held_title_tier >= tier_kingdom
										}
									}
									modifier = { #Dukes
										add = 1
										root = {
											highest_held_title_tier >= tier_duchy
										}
									}
									random_list = {
										1 = { # Superior genetics
											modifier = { #Emperors
												add = 3
												root = {
													highest_held_title_tier = tier_empire
												}
											}
											modifier = { #Kings
												add = 2
												root = {
													highest_held_title_tier >= tier_kingdom
												}
											}
											modifier = { #Dukes
												add = 1
												root = {
													highest_held_title_tier >= tier_duchy
												}
											}
											random_list = {
												20 = { # Beauty													
													add_trait = beauty_good_3
												}
												9 = { # Intellect													
													add_trait = intellect_good_3
												}
												9 = { # Physique													
													add_trait = physique_good_3
												}
												2 = { # Fecund													
													add_trait = fecund
												}
											}											
										}
										3 = { # Good genetics
											modifier = { #Emperors
												add = 3
												root = {
													highest_held_title_tier = tier_empire
												}
											}
											modifier = { #Kings
												add = 2
												root = {
													highest_held_title_tier >= tier_kingdom
												}
											}
											modifier = { #Dukes
												add = 1
												root = {
													highest_held_title_tier >= tier_duchy
												}
											}
											random_list = {
												4 = { # Beauty													
													add_trait = beauty_good_2
												}
												1 = { # Intellect													
													add_trait = intellect_good_2
												}
												1 = { # Physique													
													add_trait = physique_good_2
												}
											}											
										}
										20 = { # Decent genetics
											random_list = {
												4 = { # Beauty													
													add_trait = beauty_good_1
												}
												1 = { # Intellect													
													add_trait = intellect_good_1
												}
												1 = { # Physique													
													add_trait = physique_good_1
												}
											}											
										}
									}
									
								}
								8 = { # No good genetics

								}
							}
						}
					}
					save_scope_as = bride
				}
			}
			else_if = {
				limit = { is_female = yes }
				create_character = {
					location = root.capital_province
					template = potential_bride_character
					gender = male
					after_creation = {
						#Good genetics
						random = {
							chance = 100
							random_list = {
								3 = { # Good genetics
									modifier = { #Emperors
										add = 3
										root = {
											highest_held_title_tier = tier_empire
										}
									}
									modifier = { #Kings
										add = 2
										root = {
											highest_held_title_tier >= tier_kingdom
										}
									}
									modifier = { #Dukes
										add = 1
										root = {
											highest_held_title_tier >= tier_duchy
										}
									}
									random_list = {
										1 = { # Superior genetics
											modifier = { #Emperors
												add = 3
												root = {
													highest_held_title_tier = tier_empire
												}
											}
											modifier = { #Kings
												add = 2
												root = {
													highest_held_title_tier >= tier_kingdom
												}
											}
											modifier = { #Dukes
												add = 1
												root = {
													highest_held_title_tier >= tier_duchy
												}
											}
											random_list = {
												20 = { # Beauty													
													add_trait = beauty_good_3
												}
												9 = { # Intellect													
													add_trait = intellect_good_3
												}
												9 = { # Physique													
													add_trait = physique_good_3
												}
												2 = { # Fecund													
													add_trait = fecund
												}
											}											
										}
										2 = { # Good genetics
											modifier = { #Emperors
												add = 3
												root = {
													highest_held_title_tier = tier_empire
												}
											}
											modifier = { #Kings
												add = 2
												root = {
													highest_held_title_tier >= tier_kingdom
												}
											}
											modifier = { #Dukes
												add = 1
												root = {
													highest_held_title_tier >= tier_duchy
												}
											}
											random_list = {
												4 = { # Beauty													
													add_trait = beauty_good_2
												}
												1 = { # Intellect													
													add_trait = intellect_good_2
												}
												1 = { # Physique													
													add_trait = physique_good_2
												}
											}											
										}
										15 = { # Decent genetics
											random_list = {
												4 = { # Beauty													
													add_trait = beauty_good_1
												}
												1 = { # Intellect													
													add_trait = intellect_good_1
												}
												1 = { # Physique													
													add_trait = physique_good_1
												}
											}											
										}
									}
									
								}
								8 = { # No good genetics

								}
							}
						}
					}
					save_scope_as = bride
				}
			}
			scope:bride = {
				add_to_list = elegible_candidates
				add_to_list = chosen_candidate_list
				add_character_flag = created_bride_flag
			}
			clear_saved_scope = bride
		}
		random_in_list = {
			list = elegible_candidates
			weight = {
				base = 35
				modifier = { #Non-rejected consorts are preferred
					is_demoted_consort_trigger = no
					add = 40
				}
				modifier = { #Ready to be consorts are preferred
					is_adult = yes
					add = 25
				}
				modifier = { #Just in case
					NOT = { is_courtier_of = root }
					add = 100
				}
				modifier = { #Powerful candidates are preferred
					is_lowborn = no
					add = 10
				}
				modifier = { #More if it was set
					exists = local_var:family_background_important
					is_lowborn = no
					add = 20
				}
				modifier = { #Children of vassals are preferred
					any_close_or_extended_family_member = {
						is_vassal_of = root
					}
					add = 10
				}
				modifier = { #More if it was set
					any_close_or_extended_family_member = {
						OR = {	
							is_vassal_of = root
							is_tributary_of = root
						}
					}
					exists = local_var:family_background_important
					add = 20
				}
				modifier = { #Child of powerful vassals are preferred
					any_close_family_member = {
						OR = {
							is_powerful_vassal_of = root
							is_councillor_of = root
							is_parent_of = root
						}
					}
					add = 10
				}
				modifier = { #Child of tributaries are preferred
					any_close_family_member = {
						is_tributary_of = root
					}
					add = 15
				}
				modifier = { #More if it was set
					any_close_family_member = {
						OR = {
							is_powerful_vassal_of = root
							is_councillor_of = root
							is_parent_of = root
							AND = {
								is_tributary_of = root
								is_lowborn = no
							}
						}
					}
					exists = local_var:family_background_important
					add = 100
				}
				modifier = { #Noble rank
					any_close_family_member = {
						highest_held_title_tier >= tier_county
					}
					add = 5
				}
				modifier = { #Noble rank - preference for powerful background
					any_close_family_member = {
						highest_held_title_tier >= tier_county
					}
					exists = local_var:family_background_important
					add = 5
				}
				modifier = { #Ducal rank - preference for powerful background
					any_close_family_member = {
						highest_held_title_tier >= tier_duchy
					}
					exists = local_var:family_background_important
					add = 5
				}
				modifier = { #Royal rank - preference for powerful background
					any_close_family_member = {
						highest_held_title_tier >= tier_kingdom
					}
					exists = local_var:family_background_important
					add = 10
				}
				modifier = { #Imperial rank - preference for powerful background
					any_close_family_member = {
						highest_held_title_tier = tier_empire
					}
					exists = local_var:family_background_important
					add = 5
				}
				modifier = { #Nepotism wins if family background is important
					any_close_or_extended_family_member = {
						is_close_or_extended_family_of = root
					}
					exists = local_var:family_background_important
					add = 15
				}
				modifier = { #Trait considerations
					num_of_good_genetic_traits >= 1
					add = 5
				}
				modifier = { #Trait considerations - beauty is important
					OR = {
						has_trait = beauty_good_1
						has_trait = physique_good_1
					}
					exists = local_var:beauty_important
					add = 20
				}
				modifier = { #Trait considerations - beauty is important
					OR = {
						has_trait = beauty_good_2
						has_trait = physique_good_2
					}
					exists = local_var:beauty_important
					add = 25
				}
				modifier = { #Trait considerations - beauty is important
					OR = {
						has_trait = beauty_good_3
						has_trait = physique_good_3
					}
					exists = local_var:beauty_important
					add = 30
				}
				modifier = { #Virtuous traits are encouraged - if they were chosen
					num_sinful_traits > 0
					exists = local_var:personality_skills_important
					add = -10
				}
				modifier = { #Virtuous traits are encouraged - if they were chosen
					num_sinful_traits >= 2
					exists = local_var:personality_skills_important
					add = -10
				}
				modifier = { #Virtuous traits are encouraged - if they were chosen
					num_sinful_traits >= 3
					exists = local_var:personality_skills_important
					add = -10
				}
				modifier = { #Bonus for virtuous candidates - if virtuous traits matter
					AND = {
						num_sinful_traits = 0
						num_virtuous_traits >= 1
					}
					exists = local_var:personality_skills_important
					add = 5
				}
				modifier = { #Virtuous traits are encouraged - if they were chosen
					num_virtuous_traits >= 1
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Virtuous traits are encouraged - if they were chosen
					num_virtuous_traits >= 2
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Virtuous traits are encouraged - if they were chosen
					num_virtuous_traits >= 3
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Skill considerations - if they were chosen
					OR = {
						stewardship >= 9
						diplomacy >= 9
						learning >= 9
					}
					exists = local_var:personality_skills_important
					add = 5
				}
				modifier = { #Skill considerations - if they were chosen
					OR = {
						stewardship >= 13
						diplomacy >= 13
						learning >= 13
					}
					exists = local_var:personality_skills_important
					add = 5
				}
				modifier = { #Skill considerations - if they were chosen
					OR = {
						stewardship >= 17
						diplomacy >= 17
						learning >= 17
					}
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Bonus - skill considerations - if they were chosen
					AND = {
						stewardship >= 13
						diplomacy >= 13
						learning >= 13
					}
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = content
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = calm
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = gregarious
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = compassionate
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = forgiving
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = honest
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen - bonus for non-scheming consorts
					harem_politics_evil_consort_trigger = no
					exists = local_var:personality_skills_important
					add = 10
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = intellect_good_1
					exists = local_var:personality_skills_important
					add = 20
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = intellect_good_2
					exists = local_var:personality_skills_important
					add = 25
				}
				modifier = { #Trait considerations - if they were chosen
					has_trait = intellect_good_3
					exists = local_var:personality_skills_important
					add = 30
				}
				modifier = { #Scheming consorts will try their best to be chosen... and they make the harem interesting
					harem_politics_evil_consort_trigger = yes
					add = 15
				}
				modifier = { #Parents would not leave their children
					any_child = {
						even_if_dead = yes
						count = 0
					}
					add = 40
				}
				modifier = { #Virginity is valuable
					any_spouse = {
						even_if_dead = yes
						count = 0
					}
					add = 40
				}
				modifier = { #Characters that believe in concubinage are more elegible
					accepts_harems = yes
					add = 10
				}
			}
			save_scope_as = potential_candidate
		}
	}

	#Are we done? Yes
	if = {
		limit = {
			OR = {
				AND = {	
					exists = scope:candidate_3
					can_have_four_candidates_trigger = no
				}
				exists = scope:candidate_4
			}
		}
		trigger_event = bride_show.0006
	}
	#No
	else = {
		trigger_event = bride_show.0005
	}
}

#######################
##Choosing parameters##
#######################

##Family background##
bride_show.0001 = { 
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0001_f.t
			}
			desc = bride_show.0001_m.t
		}
		desc = bride_show.0001.t
	}
	desc = bride_show.0001.desc
	theme = realm
	
	left_portrait = { 	
		character = root
		animation = personality_honorable
	}
	
	# Family background is important
	option = {
		name = bride_show.0001.a
		trigger = {
			gold >= tiny_gold_value
		}
		show_as_unavailable = {
			gold < tiny_gold_value
		}

		remove_short_term_gold = tiny_gold_value
		
		set_local_variable = {
			name = family_background_important
			value = yes
		}
		ai_chance = { #The AI will always choose this
			base = 15
		}
	}

	#It's irrelevant
	option = {
		name = bride_show.0001.b
		ai_chance = {
			base = 1
		}
	}
	after = {
		trigger_event = {
			id = bride_show.0002
			days = { 4 8 }
		}
	}
}

##Beauty##
bride_show.0002 = { 
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0001_f.t
			}
			desc = bride_show.0001_m.t
		}
		first_valid = {
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0002.t.f
			}
			desc = bride_show.0002.t.m
		}
	}
	desc = bride_show.0002.desc
	theme = realm
	
	right_portrait = { 	
		character = root
		animation = personality_rational
	}
	
	# Beauty is important
	option = {
		name = bride_show.0002.a
		trigger = {
			gold >= tiny_gold_value
		}
		show_as_unavailable = { NOT = { gold >= tiny_gold_value } }
		flavor = { #To get warning if you don't have enough money
			triggered_desc = {
				trigger = {
					NOT = { gold >= tiny_gold_value }
				}
				desc = holy_order.0202.a._not.tt
			}
		}
		remove_short_term_gold = tiny_gold_value
		set_local_variable = {
			name = beauty_important
			value = yes
		}
		ai_chance = {
			base = 1
		}
	}

	#It's irrelevant
	option = {
		name = bride_show.0001.b
		ai_chance = { #The AI will always choose this
			base = 15
		}
	}
	after = {
		trigger_event = {
			id = bride_show.0003
			days = { 4 8 }
		}
	}
}

##Personality and skills##
bride_show.0003 = { 
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0001_f.t
			}
			desc = bride_show.0001_m.t
		}
		desc = bride_show.0003.t
	}
	desc = bride_show.0003.desc
	theme = realm
	
	left_portrait = { 	
		character = root
		animation = personality_compassionate
	}
	
	# Personality and skills are important
	option = {
		name = bride_show.0003.a
		trigger = {
			gold >= tiny_gold_value
		}
		show_as_unavailable = { NOT = { gold >= tiny_gold_value } }
		flavor = { #To get warning if you don't have enough money
			triggered_desc = {
				trigger = {
					NOT = { gold >= tiny_gold_value }
				}
				desc = holy_order.0202.a._not.tt
			}
		}
		remove_short_term_gold = tiny_gold_value
		set_local_variable = {
			name = personality_skills_important
			value = yes
		}
		ai_chance = {
			base = 1
		}
	}

	#It's irrelevant
	option = {
		name = bride_show.0001.b
		ai_chance = { #The AI will always choose this
			base = 15
		}
	}
	after = {
		trigger_event = {
			id = bride_show.0004
			days = { 20 30 }
		}
	}
}

##The show starts##
bride_show.0004 = { 
	type = character_event
	title = bride_show.0004.t
	desc = bride_show.0004.desc
	theme = realm
	
	right_portrait = { 	
		character = root
		animation = personality_rational
	}
	
	# Let's go!
	option = {
		name = bride_show.0004.a
		custom_tooltip = bride_show.0004.a.tt

		if = {
			limit = {
				NOT = {
					exists = scope:liege
				}
			}
			save_scope_as = liege
		}
		
		hidden_effect = {
			#Set up lists
			if = {
				limit = {
					any_tributary = {
						has_variable = will_send_candidates_to
						var:will_send_candidates_to = root
						OR = {
							AND = {
								exists = local_var:tributary_relatives
								any_close_family_member = {
									is_courtier_of = prev
									harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
								}
							}
							AND = {
								exists = local_var:tributary_relatives
								any_courtier = {
									harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
								}
							}
						}
					}
				}
				every_tributary = {
					limit = {
						has_variable = will_send_candidates_to
						var:will_send_candidates_to = root
						OR = {
							AND = {
								exists = local_var:tributary_relatives
								any_close_family_member = {
									is_courtier_of = prev
									harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
								}
							}
							AND = {
								exists = local_var:tributary_relatives
								any_courtier = {
									harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
								}
							}
						}
					}
					add_to_list = bride_show_event_vassal_list
				}
			}
			if = {
				limit = {
					government_has_flag = government_is_administrative
				}
				if = { #Dukes
					limit = {
						highest_held_title_tier = tier_duchy
					}
					if = { #With low authority, they need at least 3 non-powerful vassals
						limit = {
							has_realm_law = imperial_bureaucracy_0
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
					else_if = { #With limited authority, they need 3 non-dominant vassals
						limit = {
							has_realm_law = imperial_bureaucracy_1
						}
						every_vassal = {
							limit = {
								house ?= { is_dominant_family = no }
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
				}
				else_if = { #Kings
					limit = {
						highest_held_title_tier = tier_kingdom
					}
					if = { #With low authority, they need at least 3 non-powerful counts
						limit = {
							has_realm_law = imperial_bureaucracy_0
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
								highest_held_title_tier <= tier_county
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
					else_if = { #With limited authority, they need 3 non-dominant dukes or below
						limit = {
							has_realm_law = imperial_bureaucracy_1
						}
						every_vassal = {
							limit = {
								house ?= { is_dominant_family = no }
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
				}
				else_if = { #Emperors
					limit = {
						highest_held_title_tier = tier_empire
					}
					if = { #With low authority, they need at least 3 non-powerful dukes
						limit = {
							has_realm_law = imperial_bureaucracy_0
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
								highest_held_title_tier <= tier_duchy
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
					else_if = { #With limited authority, they need 3 non-dominant kings or below
						limit = {
							has_realm_law = imperial_bureaucracy_1
						}
						every_vassal = {
							limit = {
								house ?= { is_dominant_family = no }
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
				}

				if = { #With high authority, just any vassal
					limit = {
						OR = {
							has_realm_law = imperial_bureaucracy_2
							has_realm_law = imperial_bureaucracy_3
						}
					}
					every_vassal = {
						limit = {
							NOT = {
								is_in_list = bride_show_event_vassal_list
							}
						}
						add_to_list = bride_show_event_vassal_list
					}
				}
			}
			else_if = {
				limit = {
					NOT = {
						government_has_flag = government_is_administrative
					}
				}
				if = { #Dukes
					limit = {
						highest_held_title_tier = tier_duchy
					}
					if = { #If ruler is a duke with low authority, they need at least 3 non-powerful vassals
						limit = {
							OR = {
								has_realm_law = crown_authority_0
								has_realm_law = tribal_authority_0
							}
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
					else_if = { #If ruler is a duke with limited authority, they need 3 vassals
						limit = {
							OR = {
								has_realm_law = crown_authority_1
								has_realm_law = tribal_authority_1
							}
						}
						every_vassal = {
							add_to_list = bride_show_event_vassal_list
						}
					}
				}
				else_if = { #Kings
					limit = {
						highest_held_title_tier = tier_kingdom
					}
					if = { #If ruler is a king with low authority, they need at least 3 non-powerful vassals
						limit = {
							OR = {
								has_realm_law = crown_authority_0
								has_realm_law = tribal_authority_0
							}
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
								highest_held_title_tier <= tier_county
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
					else_if = { #If ruler is a king with low authority, they need at least 3 non-powerful vassals
						limit = {
							OR = {
								has_realm_law = crown_authority_1
								has_realm_law = tribal_authority_1
							}
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
				}
				else_if = { #Emperors
					limit = {
						highest_held_title_tier = tier_empire
					}
					if = { #If ruler is an emperor with low authority, they need at least 3 non-powerful vassals
						limit = {
							OR = {
								has_realm_law = crown_authority_0
								has_realm_law = tribal_authority_0
							}
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
								highest_held_title_tier <= tier_duchy
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
					else_if = { #If ruler is an emperor with low authority, they need at least 3 non-powerful vassals
						limit = {
							OR = {
								has_realm_law = crown_authority_1
								has_realm_law = tribal_authority_1
							}
						}
						every_vassal = {
							limit = {
								is_powerful_vassal = no
							}
							add_to_list = bride_show_event_vassal_list
						}
					}
				}

				if = {
					limit = {
						OR = {
							has_realm_law = crown_authority_2
							has_realm_law = crown_authority_3
							has_realm_law = tribal_authority_2
							has_realm_law = tribal_authority_3
						}
					}
					every_vassal = {
						limit = {
							NOT = {
								is_in_list = bride_show_event_vassal_list
							}
						}
						add_to_list = bride_show_event_vassal_list
					}
				}
			}
			every_in_list = {
				list = bride_show_event_vassal_list
				limit = { 
					NOR = { 
						government_has_flag = government_is_theocracy
						is_at_war_with = root
						any_close_family_member = { #You can't make demands to the imperial family
							is_liege_or_above_of = root
						}
					}
				}
				every_courtier = {
					bride_show_add_to_candidate_list_effect = yes
				}
				##Send notification##
				if = {
					limit = {
						is_ai = no
					}
					send_interface_toast = {
						type = event_generic_neutral
						title = {
							first_valid = {
								triggered_desc = {
									trigger = {
										root = {
											is_female = yes
										}
									}
									desc = bride_show.0005_f.t
								}
								desc = bride_show.0005_m.t
							}
						}
						right_icon = scope:liege
						custom_tooltip = bride_show_courtiers_desc
					}
				}
			}
			#Let's go!
			bride_show_next_candidate_effect = yes 
		}
		ai_chance = {
			base = 15
		}
	}
}

scripted_effect bride_show_break_betrothal_candidate_effect = {
	if = {
		limit = { exists = betrothed }
		root = { save_scope_as = actor }
		save_scope_as = rejecting_betrothed
		betrothed = {
			save_scope_as = recipient
			scope:recipient = { save_scope_as = rejected_betrothed }
			trigger_event = marriage_interaction.0020
			add_opinion = {
				target = root
				modifier = broke_betrothal_opinion
			}
			every_close_or_extended_family_member = {
				limit = {
					NOR = {
						this = root 
						is_close_or_extended_family_of = root
					}
				}
				custom = all_family_members
				add_opinion = {
					target = root
					modifier = broke_betrothal_opinion
				}
			}
			clear_saved_scope = recipient
		}
		break_betrothal = betrothed
		if = { #Ambitious candidates see this as an opportunity to climb up
			limit = {
				AND = {
					agrees_with_bride_show = yes
					OR = {
						has_trait = greedy
						has_trait = arrogant
						has_trait = ambitious
					}
				}
			}
		}
		else = {
			add_opinion = {
				target = root
				modifier = broke_betrothal_opinion
			}
		}
		every_close_or_extended_family_member = {
			limit = {
				NOR = {
					this = root 
					is_close_or_extended_family_of = root
					AND	= {
						agrees_with_bride_show = yes
						is_vassal_of = root
						has_vassal_stance = courtly
					}
				}
			}
			custom = all_family_members
			add_opinion = {
				target = root
				modifier = broke_betrothal_opinion
			}
		}
	}
}

#List and scopes
scripted_effect bride_show_saved_candidate_effect = {
	remove_from_list = elegible_candidates
	if = {
		limit = { NOT = { exists = scope:candidate_1 } }
		save_scope_as = candidate_1
	}
	else_if = {
		limit = { NOT = { exists = scope:candidate_2 } }
		save_scope_as = candidate_2
	}
	else_if = {
		limit = { NOT = { exists = scope:candidate_3 } }
		save_scope_as = candidate_3
	}
	else = {
		save_scope_as = candidate_4
	}
}

##Pick your candidates##
bride_show.0005 = {
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0005_f.t
			}
			desc = bride_show.0005_m.t
		}
	}
	desc = {
		first_valid = { #Intro
			triggered_desc = {
				trigger = {
					OR = {	
						exists = scope:candidate_3
						AND = {
							exists = scope:candidate_2
							can_have_four_candidates_trigger = no
						}
					}
				}
				desc = bride_show.0005.start_3.desc
			}
			triggered_desc = {
				trigger = {
					OR = {	
						exists = scope:candidate_1
						AND = {
							exists = scope:candidate_2
							can_have_four_candidates_trigger = yes
						}
					}
				}
				desc = bride_show.0005.start_2.desc
			}
			triggered_desc = {
				desc = bride_show.0005.start.desc
			}
		}
		first_valid = { #Traits
			triggered_desc = {
				trigger = { #2 #4
					OR = {
						AND = {	
							exists = scope:candidate_1
							NOT = {
								exists = scope:candidate_2
							}
						}
						AND = {
							exists = scope:candidate_3
							NOT = {
								exists = scope:candidate_4
							}
						}
					}
					scope:potential_candidate = {
						AND = {
							OR = {
								has_trait = shy
								has_trait = paranoid
								has_trait = craven
							}
							NOR = {
								has_trait = ambitious
								has_trait = brave
								has_trait = arrogant
							}
						}
					}
				}
				desc = bride_show.0005.shy_2.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						AND = {
							OR = {
								has_trait = shy
								has_trait = paranoid
								has_trait = craven
							}
							NOR = {
								has_trait = ambitious
								has_trait = brave
								has_trait = arrogant
							}
						}
					}
				}
				desc = bride_show.0005.shy.desc
			}
			triggered_desc = {
				trigger = { #2 #4
					OR = {
						AND = {	
							exists = scope:candidate_1
							NOT = {
								exists = scope:candidate_2
							}
						}
						AND = {
							exists = scope:candidate_3
							NOT = {
								exists = scope:candidate_4
							}
						}
					}
					scope:potential_candidate = {
						AND = {
							OR = {
								has_trait = brave
								has_trait = ambitious
							}
							NOR = {
								has_trait = craven
								has_trait = paranoid
								has_trait = shy
								has_trait = arrogant
							}
						}
					}
				}
				desc = bride_show.0005.brave_2.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						AND = {
							OR = {
								has_trait = brave
								has_trait = ambitious
							}
							NOR = {
								has_trait = craven
								has_trait = paranoid
								has_trait = shy
								has_trait = arrogant
							}
						}
					}
				}
				desc = bride_show.0005.brave.desc
			}
			triggered_desc = {
				trigger = { #2 #4
					OR = {
						AND = {	
							exists = scope:candidate_1
							NOT = {
								exists = scope:candidate_2
							}
						}
						AND = {
							exists = scope:candidate_3
							NOT = {
								exists = scope:candidate_4
							}
						}
					}
					scope:potential_candidate = {
						AND = {
							OR = {
								has_trait = arrogant
							}
							NOR = {
								has_trait = craven
								has_trait = paranoid
								has_trait = shy
								has_trait = brave
								has_trait = ambitious
							}
						}
					}
				}
				desc = bride_show.0005.arrogant_2.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						AND = {
							OR = {
								has_trait = arrogant
							}
							NOR = {
								has_trait = craven
								has_trait = paranoid
								has_trait = shy
								has_trait = brave
								has_trait = ambitious
							}
						}
					}
				}
				desc = bride_show.0005.arrogant.desc
			}
			triggered_desc = {
				trigger = { #2 #4
					OR = {
						AND = {	
							exists = scope:candidate_1
							NOT = {
								exists = scope:candidate_2
							}
						}
						AND = {
							exists = scope:candidate_3
							NOT = {
								exists = scope:candidate_4
							}
						}
					}
				}
				desc = bride_show.0005.generic_1_2.desc
			}
			triggered_desc = {
				desc = bride_show.0005.generic_1.desc
			}
		}
		first_valid = { #Beauty
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						has_trait = beauty_good_3
					}
				}
				desc = bride_show.0005.beautiful.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						has_trait = beauty_good_2
					}
				}
				desc = bride_show.0005.handsome.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						has_trait = beauty_good_1
					}
				}
				desc = bride_show.0005.comely.desc
			}
			triggered_desc = {
				desc = bride_show.0005.generic_2.desc
			}
		}
		first_valid = { #Intellect
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						has_trait = intellect_good_3
					}
				}
				desc = bride_show.0005.genius.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						has_trait = intellect_good_2
					}
				}
				desc = bride_show.0005.intelligent.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						has_trait = intellect_good_1
					}
				}
				desc = bride_show.0005.quick.desc
			}
			triggered_desc = {
				desc = bride_show.0005.generic_3.desc
			}
		}
		first_valid = { #Skills
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						AND = {
							diplomacy <= 11
							learning <= 11
							stewardship >= 12
						}
					}
				}
				desc = bride_show.0005.stewardship.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						AND = {
							diplomacy <= 11
							learning >= 12
							stewardship <= 11
						}
					}
				}
				desc = bride_show.0005.learning.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						AND = {
							diplomacy >= 12
							learning <= 11
							stewardship <= 11
						}
					}
				}
				desc = bride_show.0005.diplomacy.desc
			}
			triggered_desc = {
				trigger = {
					scope:potential_candidate = {
						OR = {
							AND = {
								stewardship >= 12
								learning >= 12
							}
							AND = {
								stewardship >= 12
								diplomacy >= 12
							}
							AND = {
								learning >= 12
								diplomacy >= 12
							}
						}
					}
				}
				desc = bride_show.0005.multiple.desc
			}
			triggered_desc = {
				desc = bride_show.0005.generic_4.desc
			}
		}
		desc = bride_show.0005.end.desc
	}
	theme = realm
	
	left_portrait = {
		character = scope:potential_candidate
		animation = flirtation
	}	

	immediate = {
		save_scope_as = liege
	}
	
	# Marry them
	option = {
		name = bride_show.0005.a
		trigger = {
			allowed_more_spouses = yes
			scope:potential_candidate = {
				age >= 16
			}
			age >= 16
			gold >= bride_compensation_payment_value
		}
		show_as_unavailable = { NOT = { gold >= bride_compensation_payment_value } }
		flavor = { #To get warning if you don't have enough money
			triggered_desc = {
				trigger = {
					NOT = { gold >= bride_compensation_payment_value }
				}
				desc = holy_order.0202.a._not.tt
			}
		}

		save_scope_value_as = {
			name = gold_to_pay
			value = bride_compensation_payment_value
		}
		#Reward
		if = {
			limit = {
				exists = scope:potential_candidate.court_owner
			}
			pay_short_term_gold = {
				target = scope:potential_candidate.court_owner
				gold = bride_compensation_payment_value
			}
			#Prestige
			if = {
				limit = {
					highest_held_title_tier = tier_duchy
				}
				scope:potential_candidate.court_owner = {
					add_prestige = miniscule_prestige_value
				}
			}
			else_if = {
				limit = {
					highest_held_title_tier = tier_kingdom
				}
				scope:potential_candidate.court_owner = {
					add_prestige = minor_prestige_value
				}
			}
			else_if = {
				limit = {
					highest_held_title_tier = tier_empire
				}
				scope:potential_candidate.court_owner = {
					add_prestige = medium_prestige_value
				}
			}
			scope:potential_candidate = {
				save_scope_as = candidate_marriage
				court_owner = {
					if = {
						limit = {
							any_close_family_member = {
								this = scope:candidate_marriage
							}
							is_ai = no
						}
						trigger_event = bride_show.0008
					}
					else = {
						hidden_effect = {
							send_interface_toast = {
								type = event_generic_neutral
								title = chosen_consort_t
								right_icon = scope:liege
								left_icon = scope:potential_candidate
								custom_tooltip = chosen_spouse_d
								
								show_as_tooltip = {
									scope:liege = { 
										pay_short_term_gold = {
											target = scope:potential_candidate.court_owner
											gold = bride_compensation_payment_value
										}
									}
								}
							}
						}
					}
				}
			}
			
			#Courtly vassals get a positive opinion
			if = {
				limit = {
					scope:potential_candidate.court_owner = {
						is_vassal_of = root
						has_vassal_stance = courtly
						any_close_family_member = {
							this = scope:potential_candidate
						}
						agrees_with_bride_show = yes
					}
				}
				scope:potential_candidate.court_owner = {
					add_opinion = {
						target = root
						modifier = courtly_vassal_marriage_opinion
					}
				}
			}
		}
		else = {
			pay_short_term_gold = {
				target = scope:potential_candidate
				gold = bride_compensation_payment_value
			}
			if = {
				limit = {
					highest_held_title_tier = tier_duchy
				}
				scope:potential_candidate = {
					add_prestige = miniscule_prestige_value
				}
			}
			else_if = {
				limit = {
					highest_held_title_tier = tier_kingdom
				}
				scope:potential_candidate = {
					add_prestige = minor_prestige_value
				}
			}
			else_if = {
				limit = {
					highest_held_title_tier = tier_empire
				}
				scope:potential_candidate = {
					add_prestige = medium_prestige_value
				}
			}
		}
		
		stress_impact = {
			paranoid = minor_stress_impact_gain
		}
		
		scope:potential_candidate = {
			bride_show_saved_candidate_effect = yes
			bride_show_break_betrothal_candidate_effect = yes
			hidden_effect = {
				if = {
					limit = {
						is_hostage = yes
					}
					return_hostage = yes
				}
			}
			save_scope_as = secondary_recipient
		}
		if = {
			limit = {
				is_female = yes
			}
			marry_matrilineal = scope:potential_candidate
		}
		else = {
			marry = scope:potential_candidate
		}
		
		#Marriage effects
		save_scope_as = actor
		save_scope_as = recipient
		save_scope_as = secondary_actor
		marriage_interaction_on_accept_effect = yes
		
		ai_chance = {
			base = 5
			modifier = { #Weigh down for stress
				add = -30
				OR = {
					has_trait = paranoid
					has_trait = craven
					has_trait = shy
					has_trait = chaste
					has_trait = celibate
				}
			}
			modifier = { #More likely if concubinage isn't accepted
				add = 40
				allowed_concubines = no
			}
			modifier = { #More likely if the candidate is noble
				add = 10
				scope:potential_candidate = {
					is_lowborn = no
				}
			}
			modifier = { #Less likely if the candidate is lowborn and low legitimacy
				add = -75
				OR = {
					AND = {
						highest_held_title_tier = tier_empire
						legitimacy_level <= 3
					}
					AND = {
						highest_held_title_tier = tier_kingdom
						legitimacy_level <= 2
					}
					AND = {
						highest_held_title_tier = tier_duchy
						legitimacy_level <= 1
					}
				}
				scope:potential_candidate = {
					is_lowborn = yes
				}
			}
			modifier = { #More likely if the shares same faith
				scope:potential_candidate.faith = root.faith
				add = 10
			}
			modifier = { #More likely if the shares same culture
				scope:potential_candidate.culture = root.culture
				add = 10
			}
			modifier = { #More likely if the candidate is the child of a vassal
				add = 50
				scope:potential_candidate = {
					any_close_family_member = { is_vassal_of = root }
				}
			}
			modifier = { #More likely if the candidate is the child of a powerful vassal
				add = 100
				scope:potential_candidate = {
					any_close_family_member = { 
						OR = {
							is_powerful_vassal_of = root
							is_councillor_of = root
						}
					}
				}
			}
			modifier = { #More likely if the candidate doesn't have the trait child of a concubine
				add = 10
				scope:potential_candidate = {
					NOR = {
						has_trait = child_of_concubine_female
						has_trait = child_of_concubine_male
						has_trait = wild_oat
						has_trait = bastard
					}
				}
			}
			modifier = { #More likely if root isn't married
				add = 15
				any_spouse = {
					count = 0
				}
			}
			modifier = { #More likely if the candidate has nice traits
				add = 5
				scope:potential_candidate = {
					OR = {
						has_trait = beauty_good_1
						has_trait = physique_good_1
						has_trait = intellect_good_1
					}
				}
			}
			modifier = { #More likely if the candidate has good traits
				add = 10
				scope:potential_candidate = {
					OR = {
						has_trait = beauty_good_2
						has_trait = physique_good_2
						has_trait = intellect_good_2
					}
				}
			}
			modifier = { #More likely if the candidate has excellent traits
				add = 15
				scope:potential_candidate = {
					OR = {
						has_trait = beauty_good_3
						has_trait = physique_good_3
						has_trait = intellect_good_3
					}
				}
			}
			modifier = { #More likely if the candidate is virtuous
				add = 5
				scope:potential_candidate = {
					OR = {
						num_sinful_traits = 0
						num_virtuous_traits >= 1
					}
				}
			}
			modifier = { #More likely if the candidate isn't a criminal
				add = 5
				NOT = { has_imprisonment_reason = scope:potential_candidate }
			}
			modifier = { #More likely if root doesn't have kids
				add = 5
				any_child = {
					even_if_dead = no
					count = 0
				}
			}
			modifier = { #More likely if candidate has good skills
				add = 10
				scope:potential_candidate = {
					OR = { 
						stewardship >= 9
						learning >= 9
					}
				}
			}
			modifier = { #More likely if candidate has good skills
				add = 5
				scope:potential_candidate = {
					OR = { 
						stewardship >= 13
						learning >= 13
					}
				}
			}
			modifier = { #More likely if candidate has good skills
				add = 5
				scope:potential_candidate = {
					OR = { 
						stewardship >= 17
						learning >= 17
					}
				}
			}
			compatibility_modifier = { #Trait compatibility
				who = root
				compatibility_target = scope:potential_candidate
				min = -40
				max = 40
				multiplier = 2
			}
		}
	}

	#Make them my concubine
	option = {
		name = bride_show.0005.b
		trigger = {
			allowed_concubines = yes
			allowed_more_concubines = yes
			scope:potential_candidate = {
				age >= 16
				NOT = {
					any_heir_title = {
						place_in_line_of_succession = {
							target = prev
							value <= 2
						}
					}
				}
			}
			age >= 16
			gold >= bride_compensation_payment_value
		}
		show_as_unavailable = { NOT = { gold >= bride_compensation_payment_value } }
		flavor = { #To get warning if you don't have enough money
			triggered_desc = {
				trigger = {
					NOT = { gold >= bride_compensation_payment_value }
				}
				desc = holy_order.0202.a._not.tt
			}
		}
		
		save_scope_value_as = {
			name = gold_to_pay
			value = bride_compensation_payment_value
		}
		#Reward
		if = {
			limit = {
				exists = scope:potential_candidate.court_owner
			}
			pay_short_term_gold = {
				target = scope:potential_candidate.court_owner
				gold = bride_compensation_payment_value
			}
			#Prestige
			if = {
				limit = {
					highest_held_title_tier = tier_kingdom
				}
				scope:potential_candidate.court_owner = {
					add_prestige = miniscule_prestige_value
				}
			}
			else_if = {
				limit = {
					highest_held_title_tier = tier_empire
				}
				scope:potential_candidate.court_owner = {
					add_prestige = minor_prestige_value
				}
			}
			scope:potential_candidate = {
				save_scope_as = candidate_concubinage
				court_owner = {
					if = {
						limit = {
							any_close_family_member = {
								this = scope:candidate_concubinage
							}
							is_ai = no
						}
						trigger_event = bride_show.0008
					}
					else = {
						hidden_effect = {
							send_interface_toast = {
								type = event_generic_neutral
								title = chosen_consort_t
								right_icon = scope:liege
								left_icon = scope:potential_candidate
								custom_tooltip = chosen_concubine_d
								
								show_as_tooltip = {
									scope:liege = { 
										pay_short_term_gold = {
											target = scope:potential_candidate.court_owner
											gold = bride_compensation_payment_value
										}
									}
								}
							}
						}
					}
				}
			}
			
			#Courtly vassals get a positive opinion
			if = {
				limit = {
					scope:potential_candidate.court_owner = {
						is_vassal_of = root
						has_vassal_stance = courtly
						any_close_family_member = {
							this = scope:potential_candidate
						}
						agrees_with_bride_show = yes
					}
				}
				scope:potential_candidate.court_owner = {
					add_opinion = {
						target = root
						modifier = courtly_vassal_marriage_opinion
					}
				}
			}
		}
		else = {
			pay_short_term_gold = {
				target = scope:potential_candidate
				gold = bride_compensation_payment_value
			}
			if = {
				limit = {
					highest_held_title_tier = tier_kingdom
				}
				scope:potential_candidate = {
					add_prestige = miniscule_prestige_value
				}
			}
			else_if = {
				limit = {
					highest_held_title_tier = tier_empire
				}
				scope:potential_candidate = {
					add_prestige = minor_prestige_value
				}
			}
		}
		
		stress_impact = {
			paranoid = minor_stress_impact_gain
		}
		
		scope:potential_candidate = {
			bride_show_saved_candidate_effect = yes
			bride_show_break_betrothal_candidate_effect = yes
			hidden_effect = {
				if = {
					limit = {
						is_hostage = yes
					}
					return_hostage = yes
				}
			}
			save_scope_as = recipient
			save_scope_as = secondary_recipient
		}
		save_scope_as = actor
		save_scope_as = secondary_actor
		
		#Concubinage effects
		concubine_on_accept_effect = yes
		make_concubine = scope:recipient
		
		ai_chance = {
			base = 45
			modifier = { #Weigh down for stress
				add = -30
				OR = {
					has_trait = paranoid
					has_trait = craven
					has_trait = shy
					has_trait = celibate
					has_trait = chaste
				}
			}
			modifier = { #More likely if the candidate is noble
				add = 20
				scope:potential_candidate = {
					is_lowborn = yes
				}
			}
			modifier = { #More likely if the candidate is the child of a vassal
				add = 10
				scope:potential_candidate = {
					any_close_family_member = { is_vassal_of = root }
				}
			}
			modifier = { #More likely if root doesn't have desired concubines
				add = 30
				number_of_concubines < number_of_desired_concubines
			}
			modifier = { #More likely if the number of concubines is inferior to the number of spouses
				add = 60
				root = {
					is_married = yes
				}
				any_spouse = {
					even_if_dead = no
					count < number_of_concubines
				}
			}
			modifier = { #More likely if the candidate has nice traits
				add = 15
				scope:potential_candidate = {
					has_trait = beauty_good_1
				}
			}
			modifier = { #More likely if the candidate has good traits
				add = 20
				scope:potential_candidate = {
					has_trait = beauty_good_2
				}
			}
			modifier = { #More likely if the candidate has excellent traits
				add = 25
				scope:potential_candidate = {
					OR = {
						has_trait = beauty_good_3
						has_trait = fecund
					}
				}
			}
			modifier = { #More likely if root is lustful
				add = 20
				has_trait = lustful
			}
			modifier = { #More likely if root doesn't have kids
				add = 20
				any_child = {
					even_if_dead = no
					count = 0
				}
			}
			modifier = { #More likely if candidate has good skills
				add = 15
				scope:potential_candidate = {
					OR = {
						learning >= 9
						diplomacy >= 9
					}
				}
			}
			modifier = { #More likely if candidate has good skills
				add = 5
				scope:potential_candidate = {
					OR = {
						learning >= 13
						diplomacy >= 13
					}
				}
			}
			modifier = { #More likely if candidate has good skills
				add = 5
				scope:potential_candidate = {
					OR = {
						learning >= 17
						diplomacy >= 17
					}
				}
			}
			compatibility_modifier = { #Trait compatibility
				who = root
				compatibility_target = scope:potential_candidate
				min = -50
				max = 50
				multiplier = 2
			}
			modifier = { #Less likely if they could inherit a title
				add = -20
				scope:potential_candidate = {
					any_heir_title = {
						place_in_line_of_succession = {
							target = prev
							value <= 2
						}
					}
				}
			}
		}
	}

	#Recruit to court
	option = { # Recruit to court and break betrothal
		name = bride_show.0005.c
		if = {
			limit = { #PS
				scope:potential_candidate = {
					exists = betrothed
				}
			}
			custom_tooltip = bride_show.0005.c.tt
		}
		trigger = {
			scope:potential_candidate = {
				age >= 16
				NOT = {
					any_heir_title = {
						place_in_line_of_succession = {
							target = prev
							value <= 2
						}
					}
				}
			}
			gold >= bride_compensation_payment_value
		}
		show_as_unavailable = { NOT = { gold >= bride_compensation_payment_value } }
		flavor = { #To get warning if you don't have enough money
			triggered_desc = {
				trigger = {
					NOT = { gold >= bride_compensation_payment_value }
				}
				desc = holy_order.0202.a._not.tt
			}
		}
		
		save_scope_value_as = {
			name = gold_to_pay
			value = bride_compensation_payment_value
		}
		#Reward
		if = {
			limit = {
				exists = scope:potential_candidate.court_owner
			}
			pay_short_term_gold = {
				target = scope:potential_candidate.court_owner
				gold = bride_compensation_payment_value
			}
			scope:potential_candidate = {
				save_scope_as = candidate_courtier
				court_owner = {
					if = {
						limit = {
							any_close_family_member = {
								this = scope:candidate_courtier
							}
							is_ai = no
						}
						trigger_event = bride_show.0008
					}
					else = {
						hidden_effect = {
							send_interface_toast = {
								type = event_generic_neutral
								title = chosen_candidate_t
								right_icon = scope:liege
								left_icon = scope:potential_candidate
								custom_tooltip = chosen_courtier_d
								
								show_as_tooltip = {
									scope:liege = { 
										pay_short_term_gold = {
											target = scope:potential_candidate.court_owner
											gold = bride_compensation_payment_value
										}
									}
								}
							}
						}
					}
				}
			}
			if = {
				limit = {
					scope:potential_candidate.court_owner = {
						AND = {
							is_vassal_of = root
							has_vassal_stance = courtly
							any_close_family_member = {
								this = scope:potential_candidate
							}
							agrees_with_bride_show = yes
						}
					}
				}
				scope:potential_candidate.court_owner = {
					add_prestige = miniscule_prestige_value
				}
			}
		}
		else = {
			pay_short_term_gold = {
				target = scope:potential_candidate
				gold = bride_compensation_payment_value
			}
			scope:potential_candidate = {
				add_prestige = miniscule_prestige_value
			}
		}
		
		stress_impact = {
			paranoid = minor_stress_impact_gain
		}
		
		scope:potential_candidate = {
			bride_show_saved_candidate_effect = yes
			bride_show_break_betrothal_candidate_effect = yes
		}
		if = {
			limit = {
				scope:potential_candidate = {
					NOT = {
						any_heir_title = {
							place_in_line_of_succession = {
								target = prev
								value <= 2
							}
						}
					}
				}
			}
			hidden_effect = {
				if = {
					limit = {
						scope:potential_candidate = {
							is_hostage = yes
						}
					}
					scope:potential_candidate = {
						return_hostage = yes
					}
				}
			}
			add_courtier = scope:potential_candidate
		}
		
		ai_chance = {
			base = 0
		}
	}

	#Break betrothal for kids
	option = { # I've got plans for you
		name = bride_show.0005.d
		trigger = {
			scope:potential_candidate = {
				age <= 15
			}
			gold >= bride_compensation_payment_value
		}
		show_as_unavailable = { NOT = { gold >= bride_compensation_payment_value } }
		flavor = { #To get warning if you don't have enough money
			triggered_desc = {
				trigger = {
					NOT = { gold >= bride_compensation_payment_value }
				}
				desc = holy_order.0202.a._not.tt
			}
		}
		
		save_scope_value_as = {
			name = gold_to_pay
			value = bride_compensation_payment_value
		}
		#Reward
		if = {
			limit = {
				exists = scope:potential_candidate.court_owner
			}
			pay_short_term_gold = {
				target = scope:potential_candidate.court_owner
				gold = bride_compensation_payment_value
			}
			scope:potential_candidate.court_owner = {
				if = {
					limit = {
						any_close_family_member = {
							this = scope:potential_candidate
						}
						is_ai = no
					}
					trigger_event = bride_show.0008
				}
				else = {
					hidden_effect = {
						send_interface_toast = {
							type = event_generic_neutral
							title = chosen_candidate_t
							right_icon = scope:liege
							left_icon = scope:potential_candidate
							custom_tooltip = broken_betrothal_d
							
							show_as_tooltip = {
								scope:liege = { 
									pay_short_term_gold = {
										target = scope:potential_candidate.court_owner
										gold = bride_compensation_payment_value
									}
								}
							}
						}
					}
				}
			}
			if = {
				limit = {
					scope:potential_candidate.court_owner = {
						AND = {
							is_vassal_of = root
							has_vassal_stance = courtly
							any_close_family_member = {
								this = scope:potential_candidate
							}
							agrees_with_bride_show = yes
						}
					}
				}
				scope:potential_candidate.court_owner = {
					add_prestige = miniscule_prestige_value
				}
			}
		}
		else = {
			pay_short_term_gold = {
				target = scope:potential_candidate
				gold = bride_compensation_payment_value
			}
			scope:potential_candidate = {
				add_prestige = miniscule_prestige_value
			}
		}
		
		scope:potential_candidate = {
			bride_show_saved_candidate_effect = yes
			bride_show_break_betrothal_candidate_effect = yes
		}
		
		ai_chance = {
			base = 0
		}
	}

	# Pass
	option = {
		name = bride_show.0005.e
		if = {
			limit = { 
				OR = {
					AND = {	
						exists = scope:candidate_2 
						can_have_four_candidates_trigger = no
					}
					exists = scope:candidate_3
				}
			}
			custom_tooltip = bride_show.0005.e_last.tt
		}
		else  = {
			custom_tooltip = bride_show.0005.e.tt
		}
		
		if = {
			limit = {
				exists = scope:potential_candidate.court_owner
				scope:potential_candidate.court_owner = {
					AND = {
						is_vassal_of = root
						has_vassal_stance = courtly
						any_close_family_member = {
							this = scope:potential_candidate
						}
						agrees_with_bride_show = yes
					}
				}
			}
			scope:potential_candidate.court_owner = {
				add_opinion = {
					target = root
					modifier = courtly_vassal_rejected_opinion
				}
			}
		}
		
		scope:potential_candidate = {
			bride_show_saved_candidate_effect = yes
			add_character_flag = {
				flag = rejected_candidate_flag
				days = 5
			}
			if = {
				limit = {
					AND = {
						NOR = {
							has_trait = paranoid
							has_trait = craven
							has_trait = shy
							has_trait = chaste
							has_trait = celibate
						}
						is_betrothed = no
						agrees_with_bride_show = yes
					}
				}
				add_opinion = {
					target = root
					modifier = rejected_me_opinion
				}
			}
			else_if = {
				limit = {
					AND = {
						OR = {
							has_trait = arrogant
							has_trait = greedy
							has_trait = ambitious
						}
						agrees_with_bride_show = yes
					}
				}
				add_opinion = {
					target = root
					modifier = rejected_me_opinion
				}
			}
		}
		ai_chance = {
			base = 15
			modifier = { #More likely if the candidate is not noble
				add = 20
				scope:potential_candidate = {
					is_lowborn = yes
				}
			}
			modifier = { #More likely if the candidate is not the child of a vassal
				add = 40
				scope:potential_candidate = {
					NOT = {
						any_close_family_member = { 
							is_vassal_of = root 
						}
					}
				}
			}
			modifier = { #More likely if the candidate doesn't have any good traits
				add = 15
				scope:potential_candidate = {
					NOR = {
						has_trait = beauty_good
						has_trait = intellect_good
						has_trait = physique_good
						has_trait = fecund
					}
				}
			}
			modifier = { #More likely if root is chaste
				add = 20
				has_trait = chaste
			}
			modifier = { #More likely if root has kids
				add = 15
				any_child = {
					even_if_dead = no
					count >= 1
				}
			}
			modifier = { #More likely if candidate has bad skills
				add = 15
				scope:potential_candidate = {
					OR = {
						learning <= 8
						diplomacy <= 8
						martial <= 8
						stewardship <= 8
						intrigue <= 8
						prowess <= 8
					}
				}
			}
		}
	}
	
	after = {
		hidden_effect = {
			bride_show_next_candidate_effect = yes
		}
	}

}

bride_show.0006 = {
	type = character_event
	title = bride_show.0006.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_male = yes
				}
				desc = bride_show.0006_curtsy.desc
			}
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0006_bow.desc
			}
		}
		desc = bride_show.0006.end.desc
	}
	theme = realm
	
	right_portrait = { 	
		character = root
		animation = personality_honorable
	}
	left_portrait = { 	
		character = scope:candidate_1
		animation = personality_compassionate
	}
	lower_left_portrait = { 	
		character = scope:candidate_2
	}
	lower_center_portrait = { 	
		trigger = {
			exists = scope:candidate_4
		}
		character = scope:candidate_4
	}
	lower_right_portrait = { 	
		character = scope:candidate_3
	}

	immediate = {
	}
	
	option = {
		name = bride_show.0006.a
		if = {
			limit = {
				is_valid_for_legitimacy_change = yes
			}
			add_legitimacy = miniscule_legitimacy_gain
		}
		
		hidden_effect = {
			every_in_list = {
				list = chosen_candidate_list
				if = {
					limit = {
						has_character_flag = created_bride_flag
					}
					if = {
						limit = {
							NOT = {
								exists = court_owner
							}
							has_character_flag = rejected_candidate_flag
						}
						death = {
							death_reason = death_vanished
						}
					}
					if = {
						limit = {
							is_alive = yes
						}
						remove_character_flag = created_bride_flag
					}
				}
			}
			random_list = {
				50 = {
					modifier = { # Traits
						add = 10
						has_trait = lustful
					}
					modifier = { # Traits
						add = 10
						has_trait = deviant
					}
					modifier = { # Traits
						add = 10
						has_trait = rakish
					}
					modifier = { # Tier
						add = 10
						highest_held_title_tier >= tier_kingdom
					}
					modifier = { # Consorts
						add = 10
						any_consort = {
							count >= 5
						}
					}
					trigger_event = {
						id = harem_politics.0011
						days = { 7 20 }
					}
				}
				50 = { #Nothing
					modifier = { # Traits
						add = 10
						has_trait = chaste
					}
					modifier = { # Traits
						add = 10
						has_trait = celibate
					}
					modifier = { # Traits
						add = 15
						has_trait = shy
					}
				}
				15 = {
					modifier = { # Traits
						add = 10
						has_trait = lustful
					}
					modifier = { # Traits
						add = 10
						has_trait = deviant
					}
					modifier = { # Traits
						add = 10
						has_trait = rakish
					}
					modifier = { # Tier
						add = 10
						highest_held_title_tier >= tier_duchy
					}
					modifier = { # Consorts
						add = 10
						any_consort = {
							count >= 5
						}
					}
					trigger_event = {
						id = harem_politics.0016
						days = { 7 20 }
					}
				}
			}
		}
		ai_chance = {
			base = 15
		}
	}
}

#############################
##Announcing the Bride Show##
#############################
bride_show.0007 = {
	type = letter_event
	opening = {
		first_valid = {
			triggered_desc = { #Imperial decree
			    trigger = {
					scope:liege = {
						highest_held_title_tier = tier_empire
					}
				}
				desc = bride_show.imperial.desc
			}
			triggered_desc = { #Royal decree
			    trigger = {
					scope:liege = {
						highest_held_title_tier = tier_kingdom
					}
				}
				desc = bride_show.royal.desc
			}
			triggered_desc = { #Princely decree
			    trigger = {
					scope:liege = {
						any_parent = {
							highest_held_title_tier >= tier_kingdom
						}
					}
				}
				desc = bride_show.princely.desc
			}
			desc = bride_show.noble.desc
		}
	}
	desc = {
		desc = bride_show.0007.desc.start
		first_valid = {
			triggered_desc = { #Neutral
			    trigger = {
					scope:liege = {
						allowed_to_marry_same_sex_trigger = yes
					}
				}
				desc = bride_show.0007.desc.individual
			}
			triggered_desc = { #Bachelor
			    trigger = {
					scope:liege = {
						is_female = yes
					}
				}
				desc = bride_show.0007.desc.bachelor
			}
			#Maiden
			desc = bride_show.0007.desc.maiden
		}
		desc = bride_show.0007.desc.end
	}
	sender = scope:liege

	option = {
		name = bride_show.0007.a
		ai_chance = {
			base = 1
		}
	}
}

################
##Notification##
################
bride_show.0008 = {
	type = letter_event
	opening = {
		first_valid = {
			triggered_desc = { #Imperial decree
			    trigger = {
					scope:liege = {
						highest_held_title_tier = tier_empire
					}
				}
				desc = bride_show.imperial.desc
			}
			triggered_desc = { #Royal decree
			    trigger = {
					scope:liege = {
						highest_held_title_tier = tier_kingdom
					}
				}
				desc = bride_show.royal.desc
			}
			triggered_desc = { #Princely decree
			    trigger = {
					scope:liege = {
						any_parent = {
							highest_held_title_tier >= tier_kingdom
						}
					}
				}
				desc = bride_show.princely.desc
			}
			desc = bride_show.noble.desc
		}
	}
	desc = {
		first_valid = {
			triggered_desc = { #Chosen as a spouse
				trigger = {
					exists = scope:candidate_marriage
					scope:candidate_marriage = scope:potential_candidate
				}
				desc = bride_show.married.desc
			}
			triggered_desc = { #Chosen as a consort
				trigger = {
					exists = scope:candidate_concubinage
					scope:candidate_concubinage = scope:potential_candidate
				}
				desc = bride_show.concubine.desc
			}
			triggered_desc = { #Recruited to court
				trigger = {
					exists = scope:candidate_courtier
					scope:candidate_courtier = scope:potential_candidate
				}
				desc = bride_show.recruit.desc
			}
			#Fallback
			desc = bride_show.fallback.desc
		}
	}
	sender = scope:liege
	
	immediate = {
		show_as_tooltip = {
			scope:liege = { 
				pay_short_term_gold = {
					target = root
					gold = scope:gold_to_pay
				}
			}
		}
	}

	option = {
		name = bride_show.0007.a
		ai_chance = {
			base = 1
		}
	}
}

bride_show.1000 = { 
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_female = yes
				}
				desc = bride_show.0001_f.t
			}
			desc = bride_show.0001_m.t
		}
		desc = bride_show.0001.t
	}
	desc = bride_show.0001.desc
	theme = realm
	
	right_portrait = { 	
		character = root
		animation = personality_rational
	}
	
	# Do not invite tributaries
	option = {
		name = bride_show.0001.a

		ai_chance = {
			base = 15
		}
	}

	#Invite tributaries' relatives
	option = {
		name = bride_show.0001.b

		trigger = {
			any_tributary = {
				any_close_family_member = {
					is_courtier_of = prev
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
				}
			}
		}
		custom_tooltip = bride_show_tributary_opinion_effect_tooltip

		add_prestige = medium_prestige_loss

		set_local_variable = {
			name = tributary_relatives
			value = yes
		}

		ai_chance = {
			base = 1
		}
	}

	#Invite all of a tributaries' eligible courtiers
	option = {
		name = bride_show.0001.b

		trigger = {
			any_tributary = {
				any_courtier = {
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
				}
			}
		}
		custom_tooltip = bride_show_tributary_opinion_effect_tooltip

		add_prestige = minor_prestige_loss
		
		set_local_variable = {
			name = tributary_court
			value = yes
		}

		ai_chance = {
			base = 1
		}
	}
	after = {
		if = {
			limit = {
				OR = {
					exists = local_var:tributary_court
					exists = local_var:tributary_relatives
				}
			}
			every_tributary = {
				limit = {
					OR = {
						AND = {
							exists = local_var:tributary_relatives
							any_close_family_member = {
								is_courtier_of = prev
								harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
							}
						}
						AND = {
							exists = local_var:tributary_relatives
							any_courtier = {
								harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = root }
							}
						}
					}
				}
				if = {
					limit = { 
						OR = { 
							culture = { has_cultural_pillar = heritage_east_slavic }
							culture = { has_cultural_tradition = tradition_ep3_palace_politics }
							culture = { has_cultural_tradition = tradition_legalistic }
							accepts_concubinage = yes
							accepts_polygamy = yes
						}
					}
					add_opinion = {
						target = scope:liege
						modifier = bride_show_vassal_opinion
					}
				}
				else_if = {
					limit = {
						NOR = { 
							culture = { has_cultural_pillar = heritage_east_slavic }
							culture = { has_cultural_tradition = tradition_ep3_palace_politics }
							culture = { has_cultural_tradition = tradition_legalistic }
							accepts_concubinage = yes
							accepts_polygamy = yes
						}
					}
					add_opinion = {
						target = scope:liege
						modifier = bride_show_monogamous_vassal_opinion
					}
				}
				trigger_event = {
					id = bride_show.1001
					days = { 2 7 }
				}
			}
		}
		trigger_event = {
			id = bride_show.0001
			days = { 10 14 }
		}
	}
}

bride_show.1001 = {
	type = letter_event
	opening = {
		first_valid = {
			triggered_desc = { #Imperial decree
			    trigger = {
					scope:liege = {
						highest_held_title_tier = tier_empire
					}
				}
				desc = bride_show.imperial.desc
			}
			triggered_desc = { #Royal decree
			    trigger = {
					scope:liege = {
						highest_held_title_tier = tier_kingdom
					}
				}
				desc = bride_show.royal.desc
			}
			triggered_desc = { #Princely decree
			    trigger = {
					scope:liege = {
						any_parent = {
							highest_held_title_tier >= tier_kingdom
						}
					}
				}
				desc = bride_show.princely.desc
			}
			desc = bride_show.noble.desc
		}
	}
	desc = {
		desc = bride_show.0007.desc.start
		first_valid = {
			triggered_desc = { #Neutral
			    trigger = {
					scope:liege = {
						allowed_to_marry_same_sex_trigger = yes
					}
				}
				desc = bride_show.0007.desc.individual
			}
			triggered_desc = { #Bachelor
			    trigger = {
					scope:liege = {
						is_female = yes
					}
				}
				desc = bride_show.0007.desc.bachelor
			}
			#Maiden
			desc = bride_show.0007.desc.maiden
		}
		desc = bride_show.0007.desc.end
	}
	sender = scope:liege

	trigger = {
		OR = {
			AND = {
				exists = local_var:tributary_relatives
				any_close_family_member = {
					is_courtier_of = root
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = scope:liege }
				}
			}
			AND = {
				exists = local_var:tributary_relatives
				any_courtier = {
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = scope:liege }
				}
			}
		}
	}
	immediate = {
		if = {
			limit = {
				exists = local_var:tributary_relatives
				any_close_family_member = {
					is_courtier_of = root
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = scope:liege }
				}
			}
			every_close_family_member = {
				limit = {
					is_courtier_of = root
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = scope:liege }
				}
				add_to_temporary_list = tributary_candidates
			}
		}
		else_if = {
			limit = {
				exists = local_var:tributary_court
				any_courtier = {
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = scope:liege }
				}
			}
			every_courtier = {
				limit = {
					harem_politics_eligible_bride_show_candidate_trigger = { LIEGE = scope:liege }
				}
				add_to_temporary_list = tributary_candidates
			}
		}
		save_scope_value_as = {
			name = while_count_value
			value = {
				value = 1
				if = {
					limit = { #The weaker you are, the more candidates you must send
						tier_difference = {
							target = scope:liege
							value = -2
						}
						any_in_list = {
							list = tributary_candidates
							count >= 2
						}
					}
					add = 1
				}
				else_if = {
					limit = { #The weaker you are, the more candidates you must send
						tier_difference = {
							target = scope:liege
							value = -3
						}
						any_in_list = {
							list = tributary_candidates
							count >= 3
						}
					}
					add = 2
				}
			}
		}
		while = {
			count = scope:while_count_value
			random_in_list = {
				list = tributary_candidates
				weight = {
					base = 6
					modifier = { #Suzerains would demand more legitimate heirs
						OR = {
							has_any_bastard_trait_trigger = yes
							has_trait = bastard_founder
						}
						add = -5
					}
					modifier = {
						is_child_of = root
						add = 3
					}
					modifier = { #Suzerains would demand more legitimate heirs
						is_child_of = root
						NOT = { 
							has_trait = child_of_concubine 
						}
						add = 2
					}
					modifier = {
						is_close_family_of = root
						add = 5
					}
					modifier = {
						exists = house
						add = 5
					}
					modifier = {
						num_of_good_genetic_traits >= 1
						add = 5
					}
					modifier = {
						num_of_good_genetic_traits >= 2
						add = 5
					}
					modifier = {
						is_adult = yes
						add = 10
					}
					modifier = {
						num_virtuous_traits >= 1
						num_sinful_traits = 0
						add = 5
					}
					modifier = { #Allow tributaries to keep their most important courtiers
						NOR = {
							is_knight = yes
							is_councillor_of = root
							has_any_court_position = yes
						}
						add = 5
					}
				}
				add_to_temporary_list = to_send_candidates_list
			}
		}
	}

	#Accept it
	option = {
		name = bride_show.0007.a
		set_variable = {
			name = will_send_candidates_to
			value = scope:liege
			months = 2
		}
		# Accepting it is akin to being treated as a vassal
		add_prestige = medium_prestige_loss
		hidden_effect = {
			scope:liege = {
				every_in_list = {
					list = to_send_candidates_list
					add_to_list = tributaries_list
				}
				if = {
					limit = {
						is_ai = no
					}
					send_interface_toast = {
						type = event_generic_good
						title = bride_show.1001.t
						right_icon = root
						custom_tooltip = bride_show_tributary_accepted_desc
					}
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				is_obedient_to = scope:liege
				add = 20
			}
			modifier = {
				NOT = { is_obedient_to = scope:liege }
				add = -20
			}
		}
	}

	#Decline it
	option = {
		name = bride_show.0007.b
		# Depending on the suzerain's rank, you will gain prestige
		if = {
			limit = {
				scope:liege = {
					highest_held_title_tier = tier_empire
				}
			}
			add_prestige = medium_prestige_gain
		}
		else_if = {
			limit = {
				scope:liege = {
					highest_held_title_tier = tier_kingdom
				}
			}
			add_prestige = minor_prestige_gain
		}
		else = {
			add_prestige = miniscule_prestige_gain
		}
		hidden_effect = {
			scope:liege = {
				if = {
					limit = {
						is_ai = no
					}
					send_interface_toast = {
						type = event_generic_bad
						title = bride_show.1001.t
						right_icon = root
						custom_tooltip = bride_show_tributary_refused_desc
					}
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = { #Is obedient
				is_obedient_to = scope:liege
				add = -100
			}
			modifier = { #Is not obedient
				NOT = { is_obedient_to = scope:liege }
				add = 50
			}
			modifier = { #Kings are less likely to send their relatives
				highest_held_title_tier >= tier_kingdom
				add = 10
			}
			#Traits
			modifier = {
				has_trait = shy
				NOT = { is_obedient_to = scope:liege }
				add = -10
			}
			modifier = {
				has_trait = craven
				NOT = { is_obedient_to = scope:liege }
				add = -10
			}
			modifier = {
				has_trait = loyal
				NOT = { is_obedient_to = scope:liege }
				add = -10
			}
			modifier = { #A scared vassal won't decline
				add = -25
				NOT = { is_obedient_to = scope:liege }
				has_dread_level_towards = {
					target = scope:liege
					level = 1
				}
			}
			modifier = { #A scared vassal won't decline
				add = -50
				NOT = { is_obedient_to = scope:liege }
				has_dread_level_towards = {
					target = scope:liege
					level = 2
				}
			}
			modifier = { #A scared vassal won't decline
				add = -25
				NOT = { is_obedient_to = scope:liege }
				dread_modified_ai_boldness = {
					dreaded_character = scope:liege
					value <= -75
				}
			}
			modifier = {
				has_government = herder_government
				add = -10
			}
			opinion_modifier = { #Opinion
				opinion_target = scope:liege
				min = -15
				max = 15
				multiplier = 0.15
			}
		}
	}
}
